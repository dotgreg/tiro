{"version":3,"sources":["../../shared/sockets/sockets.events.ts","managers/sockets/socket.manager.ts","../../shared/shared.config.ts","config.ts","managers/sockets/eventsListener.sockets.ts","managers/events.manager.ts","../../shared/helpers/lengthObj.helper.ts","managers/date.manager.ts","components/List.component.tsx","managers/math.manager.ts","managers/upload.manager.ts","managers/textProcessor.manager.ts","managers/device.manager.ts","managers/style.manager.ts","components/MonacoEditor.Component.tsx","managers/clipboard.manager.ts","managers/encryption.manager.ts","components/Popup.component.tsx","components/PasswordPopup.component.tsx","managers/textEditor.manager.ts","components/Icon.component.tsx","components/note/NoteToolbar.component.tsx","components/note/Note.component.tsx","managers/string.manager.ts","components/SearchBar.component.tsx","components/TreeView.Component.tsx","managers/icons.manager.ts","managers/keys.manager.ts","managers/url.manager.ts","App.tsx","index.tsx"],"names":["socketEvents","clientSocket","sharedConfig","configClient","log","socket","eventManager","version","global","socketPort","socketUrl","window","location","hostname","staticPort","staticUrl","frontendPort","frontendUrl","socketEventsManager","params","name","events","this","event","callback","key","random","each","eventFunctions","i","f","j","console","toUpperCase","obj","nb","hasOwnProperty","lengthObj","monthNames","formatDateEditor","d","getDate","getMonth","getFullYear","getHours","getMinutes","formatDateList","toString","substr","SortModesLabels","SortModes","List","props","state","hoverMode","sort","sortMode","StyledWrapper","files","map","file","className","activeFileIndex","onClick","e","onFileClicked","multiSelectMode","type","checked","multiSelectArray","includes","onChange","arr","array","value","index","indexOf","splice","removeFromNumberArray","maxVal","max","ctrlPressed","isNumber","push","x","y","numbers","getAllNumbersBetween","onMultiSelectChange","onMouseEnter","Date","modified","created","React","Component","styled","div","siofu","require","transformUrlInLinks","bodyRaw","subst","replace","transformExtrawurstLinks","body","replaceAll","transformRessourcesInHTML","currentFolderPath","ressLink","codeOpenPopup","transformImagesInHTML","deviceType","deviceWidth","innerWidth","res","styleApp","bg","dark","grey","light","GlobalCssApp","css","CssApp","v","MonacoEditorWrapper","reactComp","vimStatusBar","editor","monaco","editorDidMount","vimMode","current","initVimMode","defineTheme","base","inherit","rules","background","colors","monacoEditor","setTheme","getCurrentLineInfos","text","getValue","position","getPosition","splitedText","split","monacoPosition","lines","activeLine","lineNumber","lineIndex","createRef","nextProps","nextState","nextContext","posY","setScrollPosition","scrollTop","insertUnderCaret","trigger","ref","width","height","language","theme","options","automaticLayout","selectOnLineNumbers","minimap","enabled","wordWrap","fontSize","scrollbar","handleMouseWheel","alreadyListening","initClipboardListener","addEventListener","pasteEvent","clipboardData","undefined","items","length","blob","getAsFile","retrieveImageFromClipboardAsBlob","imageBlob","onImagePasted","encryptText","password","privateKey","cryptico","generateRSAKey","publicKey","publicKeyString","encrypt","Popup","OverlayClickPopup","onClose","PopupWrapper","title","children","PasswordPopup","passwordInput","focus","setState","target","onSubmit","isLineStartClean","str","charCodeAt","Icon","icon","fa","NoteMobileToolbar","p","StyledToolbarMobile","buttons","action","onButtonClicked","ButtonToolbar","StyledToolbar","button","Button","insideHtml","customHtml","class","marked","Note","textareaMobile","dragzone","uploadInput","previewContentWrapper","previewContent","monacoEditorComp","keyUploadSocketListener","onNoteLeaveLogic","shouldSaveOnLeave","onFileEdited","path","fileContent","shouldEncryptOnLeave","cipher","neutralizeDelayedFileSave","setTimeout","noHistoryBackup","triggerContentSaveLogic","newContent","onSavingHistoryFile","throttledOnFileEdited","debouncedOnFileEdited","historySaveInterval","historyContent","restartAutomaticHistorySave","clearInterval","setInterval","historySaveInMin","throttle","filePath","content","debounce","submitOnEnter","onFilePathEdited","editorScrollLogic","delta","deltaY","Math","min","abs","newY","previewDivWrapper","previewDiv","monacoHeight","getContentHeight","maxHeight","offsetHeight","encryptContent","status","textEncrypted","decryptContent","decrypt","decryptText","alert","plaintext","currentCursorPos","saveCursorPos","pos","getLineTextInfos","textarea","selectionStart","c","textareaPosition","saveYTextarea","resetCursorPosition","decal","setPosition","selectionEnd","resetYTextarea","onTextModifAction","newText","infos","afterTextModification","prevLine","currLine","nextLine","lineLength","startsWith","activeLineContent","trim","join","triggerTextModifAction","charDecal","onTextareaScroll","isTextareaEdited","onTextareaChange","debounceTextareaEdited","updatedText","newLetter","letterCode","lastLine","pattern1","pattern2","newLineStart","updateTextFromLetterInput","decalChars","textareaY","oldPath","oldContent","editorEnabled","dragzoneEnabled","reloadEditor","askForPassword","cb","el","imageInMd","textAreaEl","startPos","endPos","substring","insertAtCaret","on","getUploadedFile","data","submitFiles","listenOnInput","listenOnDrop","onDragStart","onDragEnd","uploadOnDrop","emit","uploadResourcesInfos","folderpath","folder","off","currentFolderArr","pop","thatNote","currentFolder","onWheelCapture","open","href","id","realname","toLowerCase","idtxt","idSearch","for","onFileDelete","onKeyDown","onScroll","dangerouslySetInnerHTML","__html","SearchBar","searchTerm","onSearchSubmit","search","onSearchTermUpdate","isSearching","motion","motionName","motionAppear","onAppearStart","node","onAppearActive","scrollHeight","onLeaveStart","onLeaveActive","LocalStorageMixin","TreeView","decorate","onDragEnter","expandedKeys","onExpand","autoExpandParent","selectedKeys","selected","draggable","onRightClick","info","onFolderRightClicked","onSelect","onFolderClicked","treeData","displayName","onKey","keyName","keyCode","up","down","ctrl","shift","alt","enter","currentUrlParams","getUrlParams","urlParams","queryString","urlParamsSearch","URLSearchParams","get","parseInt","App","listenerIds","intPageBlink","updatePageTitle","generateTitle","host","isSocketConnected","warning1","warning","document","toggleSocketConnection","toggleMobileView","mobileView","cleanFilesList","askForFolderFiles","folderPath","askForFiles","cleanAndAskForFolderFiles","askForFolderScan","askFolderHierarchy","moveFile","initPath","endPath","shouldRescan","promptAndBatchMoveFiles","confirm","fileId","filenameArr","realFileName","cleanMultiSelect","emptyFileDetails","sortFiles","sortedFiles","sortBy","toLocaleLowerCase","reverse","activeFileContent","loadFileDetails","fileIndex","endsWith","askForFileContent","initKeyboardShortcuts","onkeydown","onkeyup","lastFolderIn","lastSearchIn","shouldLoadFirstNote","onFolderFilesReceived","filter","extension","temporaryResults","selectedFolder","initSearchForContentLinks","ewTriggerSearch","term","triggerSearch","searchFor","ignoreNextUrlChange","updateAppUrl","newUrl","protocol","history","pushState","updateUrl","initUrlParamsLogic","newUrlParams","reactToUrlParams","onUrlParamsChange","log2","onpopstate","JSON","stringify","folderHierarchy","Promise","resolve","reject","socketBackend","io","connectionSuccess","connected","then","eventName","getFiles","getFileContent","activeFile","getFolderHierarchy","disconnect","reconnect","connect","prevProps","prevState","forEach","styles","askForExplorer","isListEmpty","createNote","newMode","filepath","saveFileContent","newFileContent","historyFileType","createHistoryFile","onEditorDetached","askForNotepad","ReactDOM","render","getElementById"],"mappings":"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","file":"static/js/main.7ff0395e.chunk.js","sourcesContent":["import { iFile, iFolder } from \"../types.shared\";\r\n\r\nexport enum socketEvents {\r\n    connection = 'connection',\r\n    disconnect = 'disconnect',\r\n    connect = 'connect',\r\n    reconnect = 'reconnect',\r\n    connectionSuccess = 'connectionSuccess',\r\n\r\n    askForFiles = 'askForFiles',\r\n    getFiles = 'getFiles',\r\n\r\n    askForFileContent = 'askForFileContent',\r\n    getFileContent = 'getFileContent',\r\n\r\n    saveFileContent = 'saveFileContent',\r\n    \r\n    getUploadedFile = 'getUploadedFile',\r\n\r\n    moveFile = 'moveFile',\r\n    \r\n    searchFor = 'searchFor',\r\n    \r\n    askFolderHierarchy = 'askFolderHierarchy',\r\n    getFolderHierarchy = 'getFolderHierarchy',\r\n\r\n    createNote = 'createNote',\r\n    createHistoryFile = 'createHistoryFile',\r\n\r\n    onFileDelete = 'onFileDelete',\r\n    askForExplorer = 'askForExplorer',\r\n    askForNotepad = 'askForNotepad',\r\n    uploadResourcesInfos = 'uploadResourcesInfos',\r\n\r\n}\r\n\r\nexport declare namespace iSocketEventsParams {\r\n    export interface askForFiles { folderPath: string }\r\n    export interface getFiles { files: iFile[], temporaryResults?:boolean}\r\n\r\n    export interface askForFileContent {filePath:string}\r\n    export interface getFileContent {fileContent: string, filePath:string}\r\n\r\n    export interface saveFileContent {filepath: string, newFileContent:string}\r\n\r\n    export interface moveFile {initPath: string, endPath:string}\r\n    \r\n    export interface searchFor {term:string}\r\n    export interface getUploadedFile {name:string, path:string}\r\n\r\n    export interface askFolderHierarchy {folderPath:string}\r\n    export interface getFolderHierarchy {folder: iFolder}\r\n\r\n    export interface createNote {folderPath: string}\r\n\r\n    export interface createHistoryFile {filePath: string, content: string, historyFileType: string}\r\n\r\n    export interface onFileDelete {filepath: string}\r\n    export interface askForExplorer {folderpath: string}\r\n    export interface askForNotepad {filepath: string}\r\n\r\n    export interface uploadResourcesInfos {folderpath: string}\r\n}","import * as io from 'socket.io-client'\r\nimport { socketEvents } from '../../../../shared/sockets/sockets.events';\r\nimport { configClient } from '../../config';\r\n\r\nexport let clientSocket:SocketIOClient.Socket\r\nexport const initSocketConnection = ():Promise<SocketIOClient.Socket> => {\r\n    return new Promise((resolve, reject) => {\r\n        let socketBackend = `${configClient.global.socketUrl}:${configClient.global.socketPort}`\r\n        //@ts-ignore\r\n        clientSocket = io(socketBackend);\r\n        configClient.log.socket && console.log(`[SOCKET] connecting to ${socketBackend}...`);\r\n        \r\n        // resolve then connectionSuccess is received from backend\r\n        clientSocket.on(socketEvents.connectionSuccess, (data:any) => {\r\n            configClient.log.socket &&console.log(`[SOCKET] connection successful!, socket.connected :${clientSocket.connected}`, data);\r\n            resolve(clientSocket)\r\n        });\r\n        \r\n\r\n        // clientSocket\r\n    })\r\n}","export const sharedConfig = {\r\n    socketServerPort: 3022, \r\n    frontendServerPort: 3023,\r\n    staticServerPort: 3021,\r\n\r\n    debug: {\r\n        socketEvents: true,\r\n        connection: true,\r\n    },\r\n}","import {sharedConfig} from '../../shared/shared.config';\r\n\r\nexport const configClient = {\r\n    log: {\r\n        socket: true,\r\n        eventManager: true,\r\n    },\r\n    version: 'build 14.1 01/02/2021',\r\n    global: {\r\n        socketPort: sharedConfig.socketServerPort,\r\n        socketUrl: window.location.hostname,\r\n\r\n        staticPort: sharedConfig.staticServerPort,\r\n        staticUrl: window.location.hostname,\r\n\r\n        frontendPort: sharedConfig.frontendServerPort,\r\n        frontendUrl: window.location.hostname,\r\n    }\r\n}","import { clientSocket } from \"./socket.manager\";\r\nimport { socketEvents } from \"../../../../shared/sockets/sockets.events\";\r\nimport EventManager from \"../events.manager\";\r\nimport {each} from 'lodash'\r\n\r\n// Create an event manager specialized for sockets events\r\nexport const socketEventsManager = new EventManager({name: 'Socket Event Manager'})\r\n\r\n// each socket events declared in socketEvents, if happends, trigger our eventManager\r\nexport const bindEventManagerToSocketEvents = () => {\r\n    each(socketEvents, eventName => {\r\n        clientSocket.on(eventName, (data:any) => {\r\n            socketEventsManager.trigger(eventName, data)\r\n        })\r\n    })\r\n}","import { random, each } from \"lodash\";\r\nimport { lengthObj } from \"../../../shared/helpers/lengthObj.helper\";\r\nimport { configClient } from \"../config\";\r\n\r\ninterface iEventManagerParams {\r\n  name: string\r\n}\r\n\r\nexport default class EventManager {\r\n  name: string\r\n  events:{\r\n    [key: string]: {\r\n      [key: number]: Function\r\n    }\r\n  } = {}\r\n\r\n  constructor(params:iEventManagerParams) {\r\n    this.name = params.name\r\n  }\r\n\r\n  /**\r\n   * \r\n   * @param event \r\n   * @param callback \r\n   * \r\n   * @return key of the event callback that can be disabled by .off(key)\r\n   * \r\n   */\r\n  on(event:string, callback:Function):number {\r\n    let key = random(1, 10000000)\r\n    if (!this.events[event]) this.events[event] = {}\r\n    this.events[event][key] = callback\r\n    return key\r\n  }\r\n\r\n  off(key:number) {\r\n    each(this.events, (eventFunctions,i) => {\r\n      each(eventFunctions, (f,j:any)=> {\r\n        //@ts-ignore\r\n        if (j == key) { //j,key has string and nubmer type, so ==;\r\n          delete this.events[i][j]\r\n        }\r\n      })\r\n    })\r\n  }\r\n\r\n  destroyEvent(event:string) {\r\n    delete this.events[event]\r\n  }\r\n\r\n  trigger(event:string, params?:any) {\r\n    if(configClient.log.eventManager) console.log(`%c [${this.name.toUpperCase()}] --> trigger ${event}, nb functions:`,'background: #ccc; color: blue', lengthObj(this.events[event]),`data: `, params)\r\n    if(this.events[event]) {\r\n      each(this.events[event], f => {\r\n        f(params)\r\n      })\r\n    }\r\n  }\r\n\r\n  clean() {\r\n    this.events = {}\r\n  }\r\n\r\n}","export const lengthObj = (obj:Object):number => {\r\n    let nb = 0\r\n    for (const key in obj) {\r\n        if (obj.hasOwnProperty(key)) {\r\n            nb++\r\n        }\r\n    }\r\n    return nb\r\n}","const monthNames = [\"January\", \"February\", \"March\", \"April\", \"May\", \"June\",\r\n  \"July\", \"August\", \"September\", \"October\", \"November\", \"December\"\r\n];\r\nconst monthNamesShort = [\"Jan\", \"Feb\", \"Mar\", \"Apr\", \"May\", \"June\",\r\n  \"July\", \"Aug\", \"Sept\", \"Oct\", \"Nov\", \"Dec\"\r\n];\r\n\r\n// export const formatDateEditor = (d: Date): string => {\r\n//     var datestring = d.getFullYear()  + \"-\" + (d.getMonth()+1) + \"-\" + d.getDate() + \" at \" +\r\n//     d.getHours() + \"h\" + d.getMinutes();\r\n//     return datestring\r\n// }\r\nexport const formatDateEditor = (d: Date): string => {\r\n    var datestring =   d.getDate() + \"  \" + monthNames[d.getMonth()] + \" \" + d.getFullYear() + \" at \" +\r\n    d.getHours() + \"h\" + d.getMinutes();\r\n    return datestring\r\n}\r\nexport const formatDateList = (d: Date): string => {\r\n    // var datestring =   d.getDate() + \"  \" + monthNamesShort[d.getMonth()] + \" \" + d.getFullYear() ;\r\n    var datestring =   d.getDate() + \"/\" + d.getMonth() + \"/\" + d.getFullYear().toString().substr(2) ;\r\n    return datestring\r\n}","import React from 'react';\r\nimport styled from '@emotion/styled'\r\nimport { iFile } from '../../../shared/types.shared';\r\nimport { isNumber, max } from 'lodash';\r\nimport { getAllNumbersBetween, removeFromNumberArray } from '../managers/math.manager';\r\nimport { formatDateList } from '../managers/date.manager';\r\n\r\nexport type SortMode = 'none' | 'alphabetical' | 'created' | 'modified'\r\nexport const SortModesLabels = ['none','Az','Crea','Modif']\r\nexport const SortModes = ['none','alphabetical','created','modified']\r\n// export const SortModeArr = ['none','alphabetical','created','modified']\r\n\r\nexport class List extends React.Component<{\r\n    files:iFile[]\r\n    activeFileIndex:number\r\n    hoverMode:boolean\r\n    sortMode:number\r\n    ctrlPressed:boolean\r\n    multiSelectMode:boolean\r\n    multiSelectArray:number[]\r\n    onFileClicked: (fileIndex:number) => void\r\n    onMultiSelectChange: (selectionArr:number[]) => void\r\n}, {\r\n}> {\r\n\r\n    constructor(props:any) {\r\n        super(props)\r\n        this.state = {\r\n          hoverMode: false,\r\n        }\r\n    }\r\n    \r\n    \r\n    \r\n    render() {\r\n        let sort = SortModes[this.props.sortMode]\r\n      return (\r\n        <StyledWrapper>\r\n            \r\n            <ul>\r\n                {\r\n                    this.props.files.map( (file,key) => \r\n                        <li \r\n                            className={key === this.props.activeFileIndex ? 'active' : ''}\r\n                            key={key}\r\n                            onClick={(e) => { this.props.onFileClicked(key) }}\r\n                        > \r\n                            <span className='checkbox'>\r\n                                {\r\n                                    this.props.multiSelectMode &&\r\n                                    <input \r\n                                        type=\"checkbox\" \r\n                                        checked={this.props.multiSelectArray.includes(key)} \r\n                                        onChange={e => {\r\n                                            let arr = this.props.multiSelectArray\r\n                                            \r\n                                            if (!this.props.multiSelectArray.includes(key)) {\r\n                                                let maxVal = max(arr) || 0\r\n                                                console.log(1,  key, maxVal);\r\n                                                if (this.props.ctrlPressed) {\r\n                                                    if (isNumber(maxVal) && maxVal < key) { \r\n                                                        arr.push(...getAllNumbersBetween(maxVal, key))\r\n                                                        // console.log(2, getAllNumbersBetween(key, maxVal), key, maxVal);\r\n                                                    }\r\n                                                } \r\n                                                arr.push(key)\r\n                                            } else {\r\n                                                arr = removeFromNumberArray(arr, key)\r\n                                            }\r\n                                            this.props.onMultiSelectChange(arr)\r\n                                        }} \r\n                                    />\r\n                                }\r\n                            </span>\r\n                            <span \r\n                                className='label'\r\n                                onMouseEnter={(e) => { \r\n                                    this.props.hoverMode && this.props.onFileClicked(key) \r\n                                }}>\r\n                                    {file.name}\r\n                            </span> \r\n                            <span className={`date ${sort}`} >\r\n                                    {formatDateList(\r\n                                        new Date( \r\n                                            (sort === 'modified' ? file.modified : file.created)  || 0\r\n                                        )\r\n                                    )}\r\n                            </span> \r\n                        </li>    \r\n                    )\r\n                }\r\n            </ul>\r\n        </StyledWrapper>\r\n      );\r\n    }\r\n  }\r\n  \r\n  const StyledWrapper  = styled.div`\r\n    \r\n    \r\n  `","export const getAllNumbersBetween = (x:number, y:number):number[] => {\r\n    var numbers:number[] = [];\r\n    for (let i = x; i < y; i++) {\r\n        numbers.push(i)\r\n    }\r\n    return numbers;\r\n  }\r\n\r\nexport const removeFromNumberArray = (array: number[], value:number):number[] => {\r\n    const index = array.indexOf(value);\r\n    if (index > -1) {\r\n        array.splice(index, 1);\r\n    }   \r\n    return array\r\n}","import { iSocketEventsParams, socketEvents } from \"../../../shared/sockets/sockets.events\";\r\nimport { socketEventsManager } from \"./sockets/eventsListener.sockets\";\r\nimport { clientSocket } from \"./sockets/socket.manager\";\r\n\r\n\r\n  \r\n\r\n  export interface iUploadedFile {\r\n    name:string\r\n    path:string\r\n}\r\n\r\n\r\nvar siofu = require(\"socketio-file-upload\");\r\nexport const listenOnUploadSuccess = (cb:(file:iUploadedFile) => void):number => {\r\n  return socketEventsManager.on(socketEvents.getUploadedFile, \r\n    (data:iSocketEventsParams.getUploadedFile) => {  \r\n          cb(data)\r\n      }\r\n    )\r\n  }\r\n    \r\n  export const uploadFile = (file:any) => {\r\n    var instanceFile = new siofu(clientSocket);\r\n    instanceFile.submitFiles([file]);\r\n  }\r\n\r\n  export const uploadOnInputChange = (el:HTMLTextAreaElement) => {\r\n    var instance = new siofu(clientSocket);\r\n    instance.listenOnInput(el);\r\n  }\r\n\r\n  export const uploadOnDrop = (el:HTMLTextAreaElement, events: {\r\n    onDragStart:Function\r\n    onDragEnd:Function\r\n  }) => {\r\n    var instance = new siofu(clientSocket);\r\n    instance.listenOnDrop(el);\r\n\r\n    window.addEventListener('dragenter', function(e) {\r\n        events.onDragStart()\r\n    });\r\n    \r\n    el.addEventListener('dragleave', function(e) {\r\n        events.onDragEnd()\r\n    });\r\n    window.addEventListener('drop', function(e) {\r\n        events.onDragEnd()\r\n    });\r\n  }","import {sharedConfig} from '../../../shared/shared.config'\r\nimport { configClient } from '../config';\r\n\r\nexport const transformUrlInLinks = (bodyRaw: string):string => {\r\n    const regex =  /(https?:\\/\\/([A-Za-z0-9\\/\\:\\.\\_\\-\\/\\\\\\?\\=\\&\\%\\ \\#]*))/gm;\r\n    const codeOpenPopup = `onclick=\"window.open('$1','$1','width=600,height=600');\"`\r\n    const subst = `<a href=\"#\" ${codeOpenPopup}>$2</a>`;\r\n    return bodyRaw.replace(regex, subst);\r\n}\r\n\r\nexport const transformExtrawurstLinks = (bodyRaw: string):string => {\r\n    const regex = /\\[search\\|([A-Za-z0-9\\/\\:\\.\\_\\-\\/\\\\\\?\\=\\&\\#]*)([A-Za-z0-9\\/\\:\\.\\_\\-\\/\\ \\\\\\?\\=\\&\\#]*)\\]/gm;\r\n    const subst = `<a class=\"extrawurst-link\" href=\"javascript:window.ewTriggerSearch('$1$2');\">[$1]</a>`;\r\n    let body =  bodyRaw.replace(regex, subst); \r\n    body = body.replaceAll('>[__id_', '>[');\r\n    body = body.replaceAll('>[__tags_', '>[');\r\n    body = body.replaceAll('>[__tag_', '>[');\r\n    body = body.replaceAll(' ]</a>', ']</a>');\r\n    return body\r\n}\r\n\r\n//  @TODO\r\n// add folderPath that ./.resources/image.jpg becomes localhost:8082/dir1/dir2/dir3/.resources/image.jpg\r\nexport const transformRessourcesInHTML = (currentFolderPath:string, bodyRaw: string ):string => {\r\n    const regex = /(\\!\\[([A-Za-z0-9\\/\\:\\.\\_\\-\\/\\\\\\?\\=\\&\\ \\#]*)\\]\\(([A-Za-z0-9\\/\\:\\.\\_\\-\\/\\\\\\?\\=\\&\\ \\#]*)\\))/gm;\r\n    const ressLink = `http://${configClient.global.staticUrl}:${sharedConfig.staticServerPort}/${currentFolderPath}/$3`\r\n    const codeOpenPopup = `onclick=\"window.open('${ressLink}','popupdl','width=800,height=1000');\"`\r\n    const subst = `<a href=\"#\" ${codeOpenPopup}>$2</a>`;\r\n    // const subst = `<a href=\"${ressLink}\" download=\"$2\">$2</a>`;\r\n    return bodyRaw.replace(regex, subst);\r\n}\r\nexport const transformImagesInHTML = (currentFolderPath:string, bodyRaw: string ):string => {\r\n    const regex = /(\\!\\[([A-Za-z0-9\\/\\:\\.\\_\\-\\/\\\\\\?\\=\\&\\ \\#]*)\\]\\(([A-Za-z0-9\\/\\:\\.\\_\\-\\/\\\\\\?\\=\\&\\ \\#]*\\.(jpg|jpeg|png|gif))\\))/gm;\r\n    const subst = `<img class=\"content-image\" src=\"http://${configClient.global.staticUrl}:${sharedConfig.staticServerPort}/${currentFolderPath}/$3\"  />`;\r\n    return bodyRaw.replace(regex, subst);\r\n}\r\n\r\n// console.log(transformImagesInHTML(txt));","export const isMobile = ():boolean => {\r\n    let check = false;\r\n    //@ts-ignore\r\n    (function(a){if(/(android|bb\\d+|meego).+mobile|avantgo|bada\\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(a)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\\-(n|u)|c55\\/|capi|ccwa|cdm\\-|cell|chtm|cldc|cmd\\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\\-s|devi|dica|dmob|do(c|p)o|ds(12|\\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\\-|_)|g1 u|g560|gene|gf\\-5|g\\-mo|go(\\.w|od)|gr(ad|un)|haie|hcit|hd\\-(m|p|t)|hei\\-|hi(pt|ta)|hp( i|ip)|hs\\-c|ht(c(\\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\\-(20|go|ma)|i230|iac( |\\-|\\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\\/)|klon|kpt |kwc\\-|kyo(c|k)|le(no|xi)|lg( g|\\/(k|l|u)|50|54|\\-[a-w])|libw|lynx|m1\\-w|m3ga|m50\\/|ma(te|ui|xo)|mc(01|21|ca)|m\\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\\-2|po(ck|rt|se)|prox|psio|pt\\-g|qa\\-a|qc(07|12|21|32|60|\\-[2-7]|i\\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\\-|oo|p\\-)|sdk\\/|se(c(\\-|0|1)|47|mc|nd|ri)|sgh\\-|shar|sie(\\-|m)|sk\\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\\-|v\\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\\-|tdg\\-|tel(i|m)|tim\\-|t\\-mo|to(pl|sh)|ts(70|m\\-|m3|m5)|tx\\-9|up(\\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\\-|your|zeto|zte\\-/i.test(a.substr(0,4))) check = true;})(navigator.userAgent||navigator.vendor||window.opera);\r\n    return check;\r\n  };\r\n\r\nexport type DeviceType = 'desktop'|'tablet'|'mobile'\r\nexport type MobileView = 'navigator'|'editor'|'preview'\r\n\r\nexport const deviceType = ():DeviceType => {\r\n    let deviceWidth = window.innerWidth\r\n    // console.log(deviceWidth);\r\n    \r\n    let res:DeviceType = 'desktop'\r\n    if (deviceWidth < 1100) res = 'tablet'\r\n    if (deviceWidth < 500) res = 'mobile'\r\n    return res\r\n}","import { Global, css } from '@emotion/react'\r\nimport styled from '@emotion/styled';\r\nimport { deviceType, MobileView, DeviceType } from './device.manager';\r\n\r\nlet d = deviceType()\r\n// let v = 'editor'\r\n\r\nexport const styleApp = {\r\n    inputText: `\r\n        border: none;\r\n        background: #eaeaea;\r\n        padding: 10px 2vw;\r\n        margin: 10px ; \r\n    `,\r\n    colors: {\r\n        bg: {\r\n            dark: 'rgb(39, 39, 39)' ,\r\n            grey: 'rgb(221, 221, 221)',\r\n            light: '#fceeded6'\r\n        }\r\n    }\r\n}\r\n\r\nexport const GlobalCssApp = css`\r\n  body {\r\n    margin: 0;\r\n    padding: 0px;\r\n    height: 100vh;\r\n    overflow: hidden;\r\n    background: ${styleApp.colors.bg.light};\r\n    font-size: 11px;\r\n    font-family: Consolas, Menlo, Monaco, Lucida Console, Liberation Mono, DejaVu Sans Mono, Bitstream Vera Sans Mono, Courier New, monospace, serif;\r\n  }\r\n  html, body {\r\n    overflow: hidden;\r\n    heigth: 100vh;\r\n  }\r\n  body {\r\n    position: relative;\r\n  }\r\n`\r\n\r\nexport const CssApp = styled.div<{v:MobileView }>`\r\n\r\ndisplay: flex;\r\nflex-wrap: wrap;\r\njustify-content:center;\r\n\r\n\r\n.content-image {\r\n    /* max-width: 300px; */\r\n    width: 90%;\r\n  }\r\n.full {\r\n  .content-image {\r\n    /* max-width: 10000px; */\r\n  }\r\n}\r\n\r\n.main-wrapper {\r\n  display: flex;\r\n\r\n\r\n  .mobile-view-toggler {\r\n      position: fixed;\r\n      bottom: 0px;\r\n      left: 0px;\r\n      z-index: 10;\r\n      button {\r\n        width: 33vw;\r\n        padding: 10px;\r\n      }\r\n  }\r\n\r\n  .connection-status {\r\n    position: absolute;\r\n    bottom: 5px;\r\n    right: 5px;\r\n    font-size: 9px;\r\n    z-index: 11;\r\n    .disconnected{\r\n      color:red;\r\n    }\r\n    .connected {\r\n      color: green;\r\n    }\r\n  }\r\n\r\n  ////////////////////////////////////////////v \r\n  // LEFT\r\n  ////////////////////////////////////////////v\r\n  .left-wrapper {\r\n    background: ${styleApp.colors.bg.grey}; \r\n    width: ${d === 'desktop' ? '40' : (props => props.v !== 'navigator' ? 0 : 100)}vw;\r\n    display: ${d === 'desktop' ? 'flex' : (props => props.v !== 'navigator' ? 'none' : 'flex')};\r\n    .left-wrapper-1 {\r\n      background: ${styleApp.colors.bg.dark}; \r\n      color: white;\r\n      width: 40%;\r\n      padding-left: ${d === 'desktop' ? '90' : '10'}px;\r\n      height:100vh;\r\n      overflow: hidden;\r\n      overflow-y: auto;\r\n      position: relative;\r\n\r\n      \r\n    }\r\n    .left-wrapper-2 {\r\n      width: 60%;\r\n      height:100vh;\r\n      overflow: hidden;\r\n      overflow-y: auto;\r\n    }\r\n\r\n    .list-toolbar {\r\n      padding: 0px 10px;\r\n      position: relative;\r\n      button {\r\n        margin-right: 5px; \r\n      }\r\n\r\n      .items-list-count {\r\n        position: absolute;\r\n        color: grey;\r\n        font-size: 10px;\r\n        right: 10px;\r\n        top: 5px;\r\n      }\r\n    }\r\n\r\n    .list-wrapper {\r\n      ul {\r\n          list-style: none;\r\n          padding: 0px 0px 0px 0px;\r\n          li {\r\n              padding: 5px 15px;\r\n              display: block;\r\n              border-bottom: 1px rgba(0,0,0,0.1) solid;\r\n              color: blue;\r\n              cursor: pointer;\r\n              position: relative;\r\n              &.active {\r\n                text-decoration: underline;\r\n                  font-weight: 800;\r\n                  background: #ddddff;\r\n              }\r\n              .checkbox {\r\n\r\n              }\r\n              .label {\r\n                display: inline-block;\r\n                width: 90%;\r\n              }\r\n              .date {\r\n                position: absolute;\r\n                color: #a8a6a6;\r\n                font-size: 9px;\r\n                right: 5px;\r\n                top: 6px;\r\n                &.modified {\r\n                  color: green;\r\n                }\r\n              }\r\n          }\r\n      }\r\n    }\r\n    .search-input {\r\n        input {\r\n         ${styleApp.inputText}\r\n        }\r\n    }\r\n    .search-status {\r\n      text-align: center;\r\n      font-size: 8px;\r\n    }\r\n  }\r\n\r\n  ////////////////////////////////////////////v \r\n  // RIGHT\r\n  ////////////////////////////////////////////v \r\n  .right-wrapper {\r\n      width: ${d === 'desktop' ? '70' : (props => props.v !== 'navigator' ? 100 : 0)}vw;\r\n      display: ${d === 'desktop' ? 'block' : (props => props.v !== 'navigator' ? 'block' : 'none')};\r\n      /* padding: 10px; */\r\n      padding-top: 0px;\r\n      /* max-height: 100vh;\r\n      overflow-y: auto; */\r\n    .note-wrapper {\r\n      .editor {\r\n        display: ${d === 'desktop' ? 'flex' : 'block'};\r\n        .dragzone {\r\n          &.hidden {\r\n            display:none;\r\n          }\r\n          display:block;\r\n          position: absolute;\r\n          top: 0px;\r\n          left: 0px;\r\n          width: 100vw;\r\n          height: 100vh;\r\n          z-index: 10;\r\n          background: rgba(255,255,255,0.4);\r\n        }\r\n        .editor-area {\r\n          &.inactive {\r\n            display: none;\r\n          }\r\n          width: ${d === 'desktop' ? '50%' : (props => props.v === 'editor' ? '100vw' : '0vw')};\r\n          display: ${d === 'desktop' ? 'block' : (props => props.v === 'editor' ? 'block' : 'none')};\r\n          .monaco-editor {\r\n            margin: 0px;\r\n          }\r\n          .textarea-editor {\r\n            border: none;\r\n            width: 96vw;\r\n            height: 70vh;\r\n            margin: 0px;\r\n            padding: 2vw;\r\n            background: rgba(255,255,255,0.7);\r\n          }\r\n      }\r\n        .preview-area {\r\n          .extrawurst-link {\r\n            font-weight: 800;\r\n            color: rgb(38 183 2);\r\n          }\r\n          &.full {\r\n            width: 100%;\r\n            pre {\r\n              code {\r\n                width: 90%;\r\n              }\r\n            }\r\n          }\r\n          width: ${d === 'desktop' ? '43' : (props => props.v === 'editor' ? '0' : '100')}%;\r\n          /* display: ${d === 'desktop' ? 'block' : 'none'}; */\r\n          display: ${d === 'desktop' ? 'block' : (props => props.v === 'editor' ? 'none' : 'block')};\r\n          padding: 30px 30px 30px 10px;\r\n          height: ${d === 'desktop' ? '100vh':'80vh'};\r\n          margin-bottom: 100px;\r\n          overflow: hidden;\r\n          overflow-y: scroll;\r\n\r\n          .preview-content {\r\n            margin-bottom:100px;\r\n          }\r\n          pre {\r\n            code {\r\n              display: block;\r\n              background: #434242;\r\n              border-radius: 8px;\r\n              color: rgb(243 232 223);\r\n              padding: 10px;\r\n            }\r\n          }\r\n        }\r\n      }\r\n\r\n\r\n\r\n\r\n\r\n\r\n      .toolbar-wrapper {\r\n        ${\r\n          d === 'desktop' ?\r\n          `position: absolute;\r\n          left: 70%;\r\n          width: 30%;`\r\n          : `\r\n          position: relative;\r\n          `\r\n        }\r\n        padding: 10px 0px 10px 0px;\r\n        \r\n        .upload-button-wrapper {\r\n          position: relative;  \r\n          .input-file-hidden {\r\n            width: 0.1px;\r\n            height: 0.1px;\r\n            opacity: 0;\r\n            overflow: hidden;\r\n            position: absolute;\r\n            z-index: -1;\r\n          }\r\n        }\r\n\r\n\r\n        button {\r\n          margin-right: 5px;\r\n          &.delete {\r\n            /* background: red; */\r\n            position:absolute;\r\n            right: 10px;\r\n          }\r\n        }\r\n      }\r\n    \r\n      \r\n      .title-input-wrapper {\r\n          input {\r\n            border: none;\r\n            background: #eaeaea;\r\n            padding: 10px 1vw;\r\n            margin: 10px 1vw; \r\n            width: ${d === 'desktop' ? '80%' :'96vw'};\r\n          }\r\n        }\r\n      h3 {\r\n        margin-bottom: 0px;\r\n      }\r\n      .date {\r\n        font-size: 10px;\r\n        color: grey;\r\n      }\r\n      pre {\r\n        white-space: -moz-pre-wrap; /* Mozilla, supported since 1999 */\r\n        white-space: -pre-wrap; /* Opera */\r\n        white-space: -o-pre-wrap; /* Opera */\r\n        white-space: pre-wrap; /* CSS3 - Text module (Candidate Recommendation) http://www.w3.org/TR/css3-text/#white-space */\r\n        word-wrap: break-word; /* IE 5.5+ */\r\n      }\r\n    }\r\n  }\r\n}\r\n`\r\n\r\n\r\n","import React from 'react';\r\nimport MonacoEditor from 'react-monaco-editor';\r\nimport { styleApp } from '../managers/style.manager';\r\nimport styled from '@emotion/styled'\r\nimport { initVimMode } from 'monaco-vim';\r\nimport { LineTextInfos } from '../managers/textEditor.manager';\r\n\r\nexport let monacoEditorInstance: any\r\n\r\nexport class MonacoEditorWrapper extends React.Component<{\r\n  value:string,\r\n  vimMode:boolean,\r\n  insertUnderCaret:string\r\n  posY:number\r\n  onChange:(text:string)=>void\r\n},{}> {\r\n  reactComp:any\r\n  vimStatusBar:any\r\n  constructor(props:any) {\r\n    super(props);\r\n    this.reactComp = React.createRef()\r\n    this.vimStatusBar = React.createRef()\r\n  }\r\n\r\n  editor:any\r\n  monaco:any\r\n  editorDidMount = (editor:any, monaco:any) => {\r\n    if (this.props.vimMode) {\r\n      console.log('[MONACO EDITOR] vim mode started', this.vimStatusBar.current);\r\n      initVimMode(editor, this.vimStatusBar.current)\r\n    }\r\n    this.editor = editor\r\n    this.monaco = monaco\r\n    monacoEditorInstance = this.monaco\r\n    \r\n    monaco.editor.defineTheme('customLightTheme', {\r\n      base: 'vs',\r\n      inherit: true,\r\n      rules: [{ background: 'EDF9FA' }],\r\n      colors: {\r\n          'editor.foreground': '#000000',\r\n          'editor.background': styleApp.colors.bg.light,\r\n      }\r\n    });\r\n\r\n    //@ts-ignore\r\n    window.monacoEditor = monaco.editor\r\n\r\n    monaco.editor.setTheme('customLightTheme');\r\n  }\r\n\r\n\r\n  //\r\n  // LINE MANAGER\r\n  //\r\n  getCurrentLineInfos = ():LineTextInfos => {\r\n    var text = this.editor.getValue(position);\r\n    var position = this.editor.getPosition();\r\n    var splitedText=text.split(\"\\n\");\r\n    return {\r\n      monacoPosition: this.editor.getPosition(),\r\n      lines:splitedText,\r\n      activeLine: splitedText[position.lineNumber-1],\r\n      lineIndex: position.lineNumber-1\r\n    }\r\n  }\r\n\r\n  shouldComponentUpdate ( nextProps: any,  nextState: any, nextContext: any) { \r\n    \r\n    if (this.props.posY !== nextProps.posY) {\r\n         this.editor.setScrollPosition({scrollTop: this.props.posY});\r\n    }\r\n  \r\n    if (this.props.insertUnderCaret !== nextProps.insertUnderCaret && nextProps.insertUnderCaret !== '') {\r\n      console.log(`[MONACO EDITOR] insert under Caret ${nextProps.insertUnderCaret}`);\r\n      this.editor.trigger('keyboard', 'type', {text: nextProps.insertUnderCaret});\r\n    }\r\n    return true\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <StyledWrapper>\r\n        \r\n          <div \r\n            className={`vim-status-bar ${this.props.vimMode ? `active` : ``}`} \r\n            ref={this.vimStatusBar}>\r\n          </div>\r\n          <MonacoEditor\r\n            ref={this.reactComp}\r\n            width=\"100%\"\r\n            height=\"100%\"\r\n            language=\"markdown\"\r\n            theme=\"vs\"\r\n            value={this.props.value}\r\n            options={{\r\n              automaticLayout: true,\r\n              selectOnLineNumbers: true,\r\n              minimap: {enabled: false},\r\n              wordWrap: 'on',\r\n              fontSize: 11,\r\n              scrollbar: {\r\n                handleMouseWheel: false\r\n              }\r\n            }}\r\n            editorDidMount={this.editorDidMount}\r\n            onChange={(text) => {\r\n              this.props.onChange(text)\r\n            }}\r\n            // editorDidMount={this.reactCompDidMount}\r\n          />\r\n      </StyledWrapper>\r\n    );\r\n  }\r\n}\r\n\r\nconst StyledWrapper  = styled.div`\r\n    height: 100vh;\r\n    .scroll-wrapper {\r\n      width: 100%;\r\n      height: 100%;\r\n    }\r\n    .vim-status-bar {\r\n      &.active {\r\n        display: block\r\n      }\r\n      display: none;\r\n      position: fixed;\r\n      bottom: 0px;\r\n      height: 18px;\r\n      padding: 5px 5px 7px 5px;\r\n      width: 80%;\r\n      z-index: 1;\r\n      background: rgba(255,255,255,0.9);\r\n      input {\r\n        background: #eeeeee;\r\n        border: none;\r\n        margin: 0px 5px;\r\n      }\r\n    }\r\n`","\r\nlet alreadyListening = false\r\nexport const initClipboardListener = (events: {\r\n    onImagePasted: (Blob:any) => void\r\n}) => {\r\n    const retrieveImageFromClipboardAsBlob = (pasteEvent, callback) => {\r\n        if(pasteEvent.clipboardData == false){\r\n            if(typeof(callback) == \"function\"){\r\n                callback(undefined);\r\n            }\r\n        };\r\n    \r\n        var items = pasteEvent.clipboardData.items;\r\n        console.log(pasteEvent, items, items.length);\r\n        \r\n    \r\n        if(items == undefined){\r\n            if(typeof(callback) == \"function\"){\r\n                callback(undefined);\r\n            }\r\n        };\r\n    \r\n        for (var i = 0; i < items.length; i++) {\r\n            // Skip content if not image\r\n            // console.log(i,items[i].type);\r\n            \r\n            if (items[i].type.indexOf(\"image\") == -1) continue;\r\n            // Retrieve image on clipboard as blob\r\n            var blob = items[i].getAsFile();\r\n    \r\n            if(typeof(callback) == \"function\"){\r\n                callback(blob);\r\n            }\r\n        }\r\n    }\r\n    \r\n    if (alreadyListening) return\r\n    alreadyListening = true\r\n    \r\n    window.addEventListener(\"paste\", function(e){\r\n        retrieveImageFromClipboardAsBlob(e, function(imageBlob){\r\n            if(imageBlob){\r\n                events.onImagePasted(imageBlob)\r\n            }\r\n        });\r\n    }, false);\r\n}","import cryptico from 'cryptico'\r\n\r\nconst password:{value:string|null} = {value: null}\r\n\r\ninterface encryptionAnswer {status: string, cipher?:string, plaintext?:string}\r\n\r\nvar Bits = 1024; \r\nexport const encryptText = (text:string, password:string):encryptionAnswer => {\r\n    var privateKey = cryptico.generateRSAKey(password, Bits);\r\n    var publicKey = cryptico.publicKeyString(privateKey); \r\n    let results = cryptico.encrypt(text, publicKey) as encryptionAnswer\r\n    // if (results.cipher) return results.cipher\r\n    // console.error('[ENCRYPT TEXT] failed to encrypt text, return original text', results)\r\n    return results\r\n}\r\n\r\nexport const decryptText = (text:string, password:string):encryptionAnswer => {\r\n    var privateKey = cryptico.generateRSAKey(password, Bits);\r\n    let results = cryptico.decrypt(text, privateKey) as encryptionAnswer;\r\n    // if (results.plaintext) return results.plaintext\r\n    // console.error('[DECRYPT TEXT] failed to decrypt text, return original text', results)\r\n    return results\r\n}","import React from 'react'\r\nimport styled from '@emotion/styled'\r\n\r\n/**\r\n * Generic popup system\r\n */\r\nexport class Popup extends React.Component\r\n    <{\r\n        onClose:Function, \r\n        title:string,\r\n    }, {\r\n        \r\n    }> {\r\n\r\n    render() {\r\n      return (\r\n        <>\r\n            <OverlayClickPopup onClick={e => {this.props.onClose()}}></OverlayClickPopup>\r\n            {/* <OverlayClickPopup onClick={e => {}}></OverlayClickPopup> */}\r\n            <PopupWrapper>\r\n                <div className=\"popupTitle\"> {this.props.title}</div>\r\n                <div className=\"popupContent\">{this.props.children}</div>\r\n            </PopupWrapper>\r\n        </>\r\n      )\r\n    }\r\n}\r\n\r\nconst PopupWrapper = styled.div`\r\n    position: absolute;\r\n    z-index:1001;\r\n    left: 50%;\r\n    top:50%;\r\n    width : auto;\r\n    font-family: sans-serif;\r\n    transform:translate(-50%,-50%);\r\n    background: white;\r\n    .popupTitle {\r\n        margin: 0px 0px 20px 0px;\r\n        text-align: left;\r\n        background: grey;\r\n        color: white;\r\n        font-size: 14px;\r\n        padding: 5px 0px 5px 20px;\r\n    }\r\n    .popupContent {\r\n        padding: 0px 20px 20px 20px;\r\n        min-width : 350px;\r\n    }\r\n    img{\r\n        padding: 0px 5px 0px 0px;\r\n        margin: 5px 5px 0px 0px;\r\n    }\r\n`\r\nconst OverlayClickPopup  = styled.div`\r\n    position: absolute;\r\n    z-index:1000;\r\n    top: 0px;\r\n    left: 0px;\r\n    width: 100vw;\r\n    height: 100vh;\r\n    background: rgba(0,0,0,0.1);\r\n`\r\n  ","import React from 'react';\r\nimport styled from '@emotion/styled'\r\nimport { Popup } from './Popup.component';\r\n\r\nexport class PasswordPopup extends React.Component<{\r\n    onSubmit: (password:string) => void\r\n    onClose:Function\r\n}, {\r\n    password: string\r\n}> {\r\n\r\n    passwordInput:any\r\n    constructor(props:any) {\r\n        super(props)\r\n        this.passwordInput = React.createRef()\r\n        this.state = {\r\n          password: '',\r\n        }\r\n    }\r\n\r\n    componentDidMount() {\r\n        this.passwordInput.current.focus()\r\n    }\r\n    \r\n    render() {\r\n      return (\r\n        <StyledWrapper>\r\n            <Popup\r\n                title=\"please enter your password\"\r\n                onClose={() => {this.props.onClose()}}\r\n            >\r\n                <div>\r\n                    <input \r\n                        ref={this.passwordInput}\r\n                        type=\"password\" \r\n                        value={this.state.password} \r\n                        onChange={(e) => {\r\n                            this.setState({password: e.target.value})\r\n                        } } />\r\n                    <input type=\"button\" value='submit' onClick={e => {\r\n                        this.props.onSubmit(this.state.password)\r\n                    }}/>\r\n                </div>\r\n            </Popup>\r\n        </StyledWrapper>\r\n      );\r\n    }\r\n  }\r\n  \r\n  const StyledWrapper  = styled.div`\r\n    \r\n    \r\n  `","export const insertAtCaret =  (textarea:HTMLTextAreaElement, text:string) => {\r\n    text = text || '';\r\n   if (textarea.selectionStart || textarea.selectionStart === 0) {\r\n      // Others\r\n      var startPos = textarea.selectionStart;\r\n      var endPos = textarea.selectionEnd;\r\n      textarea.value = textarea.value.substring(0, startPos) +\r\n        text +\r\n        textarea.value.substring(endPos, textarea.value.length);\r\n      textarea.selectionStart = startPos + text.length;\r\n      textarea.selectionEnd = startPos + text.length;\r\n    } else {\r\n      textarea.value += text;\r\n    }\r\n  };\r\n\r\n\r\n\r\n  export interface LineTextInfos {\r\n    activeLine: string\r\n    lines: string[]\r\n    lineIndex: number\r\n    monacoPosition?: any\r\n    textareaPosition?: number\r\n  }\r\n\r\n  export const getLines = (rawtext:string):string[] => {\r\n    return rawtext.split(\"\\n\");\r\n  }\r\n\r\n  export const getCurrentLineInfos =  (textarea:HTMLTextAreaElement):LineTextInfos => {\r\n      // if (!textarea) return\r\n      let text = textarea.value\r\n      // var position = this.editor.getPosition();\r\n      var splitedText=text.split(\"\\n\");\r\n      let pos = textarea.selectionStart\r\n\r\n      let c = 0\r\n      let lineIndex = 0\r\n      while (c < pos+1) {\r\n        let lineLength = splitedText[lineIndex].length + 1\r\n        // c += lineLength === 0 ? 1 : lineLength\r\n        c += lineLength\r\n        lineIndex++\r\n      }\r\n      lineIndex--\r\n\r\n      return {\r\n        textareaPosition: pos,\r\n        lines:splitedText,\r\n        activeLine: splitedText[lineIndex],\r\n        lineIndex\r\n      }\r\n  };\r\n\r\n\r\nexport const diffStr = (s1:string, s2:string) => {\r\n  return s1.split(s2).join('')\r\n}\r\n\r\nconst isLineStartClean = (str:string):boolean => {\r\n  let res = true\r\n  for (let i = 0; i < str.length; i++) {\r\n    if (\r\n      str[i].charCodeAt(0) !== 32 &&\r\n      str[i].charCodeAt(0) !== 45 &&\r\n      str[i].charCodeAt(0) !== 91 &&\r\n      str[i].charCodeAt(0) !== 93\r\n    ) {\r\n      res = false\r\n    }\r\n  }\r\n  return res\r\n}\r\n\r\n\r\n\r\n\r\n\r\nexport const updateTextFromLetterInput = (\r\n  infos: LineTextInfos, \r\n  letterCode:number, \r\n  afterTextModification:(decal:number)=>void\r\n):string => {\r\n\r\n  // IF ENTER\r\n  if (letterCode === 10) {\r\n    let lastLine = infos.lines[infos.lineIndex-1]\r\n    let pattern1 = lastLine.indexOf('- [')\r\n    let pattern2 = lastLine.indexOf('-')\r\n    let newLineStart = ''\r\n\r\n    // IF LAST LINE STARTS \"-\", DUPLICATE START\r\n    if (pattern1 !== -1) {\r\n      newLineStart = lastLine.substr(0, pattern1 + 3 ) + ' ] '\r\n      if (isLineStartClean(newLineStart)) {\r\n        infos.lines[infos.lineIndex] = newLineStart + infos.activeLine\r\n        setTimeout(() => { afterTextModification(newLineStart.length) })\r\n      }\r\n\r\n\r\n\r\n    // IF LAST LINE STARTS \"- [ ] \", DUPLICATE START\t\r\n    } else if (pattern2 !== -1) {\r\n      newLineStart = lastLine.substr(0, pattern2+1) + ' ' \r\n      if (isLineStartClean(newLineStart)) {\r\n        infos.lines[infos.lineIndex] = newLineStart + infos.activeLine\r\n        setTimeout(() => { afterTextModification(newLineStart.length) })\r\n      }\r\n    }\r\n\r\n\r\n  } /** END ON ENTER LOGIC */\r\n\r\n  return infos.lines.join('\\n')\r\n}\r\n\r\nexport type TextModifAction = '->'|'<-'|'[x]'|'^'|'v'|'X'\r\n\r\nexport const triggerTextModifAction = (\r\n  action: TextModifAction, \r\n  infos:LineTextInfos, \r\n  afterTextModification:(decal:number)=>void\r\n):string => {\r\n  let lines = infos.lines\r\n  \r\n  if (action === '^') {\r\n    let prevLine = lines[infos.lineIndex - 1]\r\n    let currLine = lines[infos.lineIndex ]\r\n    lines[infos.lineIndex] = prevLine\r\n    lines[infos.lineIndex - 1] = currLine\r\n    afterTextModification(-prevLine.length-1)\r\n  }\r\n  if (action === 'v') {\r\n    let nextLine = lines[infos.lineIndex + 1]\r\n    let currLine = lines[infos.lineIndex ]\r\n    lines[infos.lineIndex] = nextLine\r\n    lines[infos.lineIndex + 1] = currLine\r\n    afterTextModification(+nextLine.length+1)\r\n  }\r\n  if (action === 'X') {\r\n    let lineLength = lines[infos.lineIndex].length\r\n    lines.splice(infos.lineIndex,1)\r\n    afterTextModification(-lineLength-1)\r\n  }\r\n\r\n  if (action === '->') {\r\n    lines[infos.lineIndex] = '  ' + lines[infos.lineIndex]\r\n    afterTextModification(2)\r\n  }\r\n  if (action === '<-') {\r\n    if (infos.activeLine.startsWith('  ')){\r\n      lines[infos.lineIndex] = lines[infos.lineIndex].substr(2,lines[infos.lineIndex].length)\r\n      afterTextModification(-2)\r\n    } else {\r\n      afterTextModification(0)\r\n    }\r\n  }\r\n\r\n  let activeLineContent = infos.activeLine.trim()\r\n\r\n  if (action === '[x]') {\r\n    if (!activeLineContent.startsWith('- [ ]') && !activeLineContent.startsWith('- [x]')){\r\n      lines[infos.lineIndex] = lines[infos.lineIndex].replace(activeLineContent, '- [ ] ' + activeLineContent.replace('-',''))\r\n      afterTextModification(6)\r\n    } else if (activeLineContent.startsWith('- [ ]')){\r\n      lines[infos.lineIndex] = lines[infos.lineIndex].replace('[ ]', '[x]')\r\n      afterTextModification(0)\r\n    } else if (activeLineContent.startsWith('- [x]')){\r\n      lines[infos.lineIndex] = lines[infos.lineIndex].replace('[x]', '[ ]')\r\n      afterTextModification(0)\r\n    } else {\r\n      afterTextModification(0)\r\n    }\r\n  }\r\n\r\n  return lines.join('\\n')\r\n}","import { FontAwesomeIcon } from '@fortawesome/react-fontawesome'\r\nimport * as fa from '@fortawesome/free-solid-svg-icons'\r\nimport React from 'react'; \r\n\r\n// fa.faCheckDouble\r\n\r\nexport class Icon extends React.Component<{\r\n    name: string\r\n}, {}> {\r\n    render() {\r\n      return (\r\n        <FontAwesomeIcon icon={fa[this.props.name]} />\r\n      );\r\n    }\r\n  } ","import React, { ReactElement } from 'react';\r\nimport styled from '@emotion/styled'\r\nimport { TextModifAction } from '../../managers/textEditor.manager';\r\nimport { Icon } from '../Icon.component';\r\nimport { capitalize } from 'lodash';\r\nimport { Note } from './Note.component';\r\nimport { textToId } from '../../managers/string.manager';\r\nimport { title } from 'process';\r\n \r\n\r\n\r\n\r\n//\r\n// MAIN TOOLBAR\r\n//\r\n\r\nexport const mainEditorToolbarConfig = (thatNote: Note) => [\r\n  {\r\n    title:'toggle editor', \r\n    icon:'faEdit', \r\n    action: () => {thatNote.setState({editorEnabled: !thatNote.state.editorEnabled})}\r\n  },\r\n  {\r\n    title:'detach in new window', \r\n    icon:'faExternalLinkAlt', \r\n    action: () => {\r\n      window.open(window.location.href,'popupDetached','width=600,height=600');\r\n    }\r\n  },\r\n  {\r\n    title:'insert unique id', \r\n    icon:'faFingerprint', \r\n    action: () => { \r\n      let newContent = thatNote.state.fileContent\r\n      let id = textToId(thatNote.props.file.realname)\r\n      let idtxt = `--id-${id}`\r\n      let idSearch = `__id_${id}`\r\n      let folder = `${thatNote.props.file.folder}`\r\n      newContent = `${idtxt}\\n[search|${idSearch} ${folder}]\\n` + newContent\r\n      thatNote.setState({fileContent: newContent})\r\n    }\r\n  },\r\n  {\r\n    title:'encrypt text', \r\n    icon:'faLock', \r\n    action: () => {\r\n      if (!thatNote.state.password) thatNote.setState({askForPassword: 'toEncrypt'})\r\n      else thatNote.encryptContent()\r\n    }\r\n  },\r\n  {\r\n    title:'decrypt text', \r\n    icon:'faUnlock', \r\n    action: () => {\r\n      if (!thatNote.state.password) thatNote.setState({askForPassword: 'toDecrypt'})\r\n      else thatNote.decryptContent()\r\n    }\r\n  },\r\n  {\r\n    title:'upload files', \r\n    class:'upload-button-wrapper',\r\n    customHtml: <>\r\n      <input className='input-file-hidden' id=\"file\" name=\"file\" type=\"file\" ref={thatNote.uploadInput}  />\r\n      <label \r\n        //@ts-ignore \r\n        for=\"file\"><Icon name=\"faPaperclip\" /></label>\r\n    </>\r\n  },\r\n  {\r\n    title:'delete note', \r\n    class:'delete',\r\n    icon:'faTrash', \r\n    action: () => {\r\n      thatNote.props.onFileDelete(thatNote.props.file.path) \r\n    }\r\n  },\r\n]\r\n\r\n\r\n\r\n\r\n//\r\n// MOBILE TOOLBAR\r\n//\r\n\r\nexport const NoteMobileToolbar = (p:{\r\n  onButtonClicked: (action:TextModifAction)=>void\r\n}) => {\r\n  return <StyledToolbarMobile>\r\n    <ButtonToolbar\r\n      buttons={[\r\n        { title: '<-', action: () => p.onButtonClicked('<-') },\r\n        { title: '->', action: () => p.onButtonClicked('->') },\r\n        { title: '[x]', action: () => p.onButtonClicked('[x]') },\r\n        { title: '^', action: () => p.onButtonClicked('^') },\r\n        { title: 'v', action: () => p.onButtonClicked('v') },\r\n        { title: 'X', action: () => p.onButtonClicked('X') },\r\n      ]}\r\n    />\r\n  </StyledToolbarMobile>\r\n}\r\n\r\nconst StyledToolbarMobile  = styled.div`\r\n  position: fixed;\r\n  bottom: 40px;\r\n`\r\n\r\n\r\n\r\n//\r\n// LOW LEVEL GENERIC\r\n//\r\n\r\n\r\nexport interface ToolbarButton {\r\n  icon?:string\r\n  title?:string\r\n  class?:string\r\n  customHtml?: ReactElement\r\n  action?:Function\r\n}\r\n\r\nexport const ButtonToolbar = (p:{buttons: ToolbarButton[]}) => {\r\n\r\n  return <StyledToolbar>\r\n    <ul className='toolbar'>\r\n      {\r\n        p.buttons.map(button => \r\n          <li title={button.title}>\r\n            <Button {...button}/>\r\n          </li>  \r\n        )\r\n      }\r\n    </ul>\r\n  </StyledToolbar>\r\n}\r\nconst StyledToolbar  = styled.div`\r\n    ul.toolbar {\r\n      display: flex;\r\n      list-style: none;\r\n      li {\r\n\r\n      }\r\n    }\r\n`\r\n\r\n\r\nexport const Button = (p:ToolbarButton) => {\r\n  let insideHtml = <></>\r\n  if (p.title) insideHtml =  <>{p.title}</>\r\n  if (p.icon) insideHtml =  <Icon name={p.icon} />\r\n  if (p.customHtml) insideHtml =  p.customHtml\r\n\r\n  return <button \r\n    className={p.class}\r\n    onClick={e => {p.action && p.action(e)}}> \r\n    { insideHtml }\r\n  </button>\r\n}\r\n\r\n","import React from 'react';\r\nimport styled from '@emotion/styled'\r\nimport { iFile } from '../../../../shared/types.shared';\r\nimport { debounce, throttle } from 'lodash';\r\nimport { listenOnUploadSuccess, uploadFile, uploadOnDrop, uploadOnInputChange } from '../../managers/upload.manager';\r\nimport { transformExtrawurstLinks, transformImagesInHTML, transformRessourcesInHTML, transformUrlInLinks } from '../../managers/textProcessor.manager';\r\nimport { MonacoEditorWrapper } from '../MonacoEditor.Component';\r\nimport { clientSocket } from '../../managers/sockets/socket.manager';\r\nimport { iSocketEventsParams, socketEvents } from '../../../../shared/sockets/sockets.events';\r\nimport { formatDateEditor } from '../../managers/date.manager';\r\nimport { Icon } from '../Icon.component';\r\nimport { safeString } from '../../managers/string.manager';\r\nimport { initClipboardListener } from '../../managers/clipboard.manager';\r\nimport { socketEventsManager } from '../../managers/sockets/eventsListener.sockets';\r\nimport { deviceType } from '../../managers/device.manager';\r\nimport { decryptText, encryptText } from '../../managers/encryption.manager';\r\nimport { PasswordPopup } from '../PasswordPopup.component';\r\nimport { getCurrentLineInfos, insertAtCaret, LineTextInfos, TextModifAction, triggerTextModifAction, updateTextFromLetterInput } from '../../managers/textEditor.manager';\r\nimport {  ButtonToolbar, mainEditorToolbarConfig, NoteMobileToolbar } from './NoteToolbar.component';\r\nconst marked = require('marked');\r\n\r\nexport interface NoteProps {\r\n  file:iFile\r\n  fileContent:string\r\n  onFileEdited: (filepath:string, content:string) => void\r\n  onFilePathEdited: (initPath:string, endPath:string) => void\r\n  onSavingHistoryFile: (filepath:string, content:string, historyFileType: string) => void\r\n  onFileDelete: (filepath:string) => void\r\n  onEditorDetached: (filepath:string) => void\r\n}\r\ninterface State {\r\n  editorEnabled: boolean\r\n  fileContent: string\r\n  dragzoneEnabled: boolean\r\n  shouldSaveOnLeave: boolean\r\n  filePath: string\r\n  insertUnderCaret: string\r\n  vimMode: boolean\r\n  reloadEditor: boolean\r\n  posY:number\r\n  password:string|null\r\n  askForPassword: string|null\r\n  monacoEditor:MonacoEditorWrapper|null\r\n}\r\n\r\n\r\nexport class Note extends React.Component<NoteProps, State> {\r\n\r\n    textareaMobile:any\r\n    dragzone:any\r\n    uploadInput:any\r\n    previewContentWrapper:any\r\n    previewContent:any\r\n    monacoEditorComp:any\r\n    constructor(props:any) {\r\n        super(props)\r\n        this.state = {\r\n          editorEnabled: true,\r\n          fileContent: '',\r\n          shouldSaveOnLeave: false,\r\n          dragzoneEnabled: false,\r\n          vimMode: false,\r\n          filePath: '',\r\n          insertUnderCaret: '',\r\n          reloadEditor: false,\r\n          posY: 0,\r\n          askForPassword: null,\r\n          password: null,\r\n          monacoEditor: null\r\n        }\r\n        this.textareaMobile = React.createRef()\r\n        this.dragzone = React.createRef()\r\n        this.uploadInput = React.createRef()\r\n        this.previewContentWrapper = React.createRef()\r\n        this.previewContent = React.createRef()\r\n        this.monacoEditorComp = React.createRef()\r\n\r\n        setTimeout(() => {\r\n          console.log(this.monacoEditorComp)\r\n        }, 1000)\r\n    }\r\n    \r\n    \r\n    \r\n    \r\n    \r\n    \r\n    \r\n    //\r\n    // LIFECYCLES\r\n    // \r\n\r\n    keyUploadSocketListener:number = -1\r\n    componentDidMount() {\r\n      console.log('[EDITOR] MOUNTED');\r\n      this.restartAutomaticHistorySave()\r\n\r\n      this.keyUploadSocketListener = listenOnUploadSuccess((file) => {\r\n        let imageInMd = `![${safeString (file.name)}](${file.path})\\n\\n`\r\n        this.setState({insertUnderCaret: imageInMd})\r\n\r\n        let textAreaEl = this.textareaMobile.current\r\n        if (textAreaEl) {\r\n          insertAtCaret(textAreaEl, imageInMd)\r\n          this.triggerContentSaveLogic(textAreaEl.value)\r\n        }\r\n      })\r\n\r\n      initClipboardListener({\r\n        onImagePasted: (imageBlob) => {\r\n          uploadFile(imageBlob)\r\n        }\r\n      })\r\n\r\n      uploadOnInputChange(this.uploadInput.current)\r\n      uploadOnDrop(this.dragzone.current, {\r\n        onDragEnd: () => {this.setState({dragzoneEnabled: false})},\r\n        onDragStart: () => { this.setState({dragzoneEnabled: true})\r\n          clientSocket.emit(socketEvents.uploadResourcesInfos, \r\n            {folderpath: this.props.file.folder} as iSocketEventsParams.uploadResourcesInfos) \r\n        },\r\n      })\r\n    }\r\n\r\n\r\n    shouldComponentUpdate ( nextProps: any,  nextState: any, nextContext: any) { \r\n      if (this.props.file !== nextProps.file) {\r\n        this.onNoteLeaveLogic()\r\n        \r\n        this.setState({shouldSaveOnLeave: false, password: null})\r\n\r\n        console.log('[EDITOR] ON CHANGING DOCUMENT', nextProps.file);\r\n        clientSocket.emit(socketEvents.uploadResourcesInfos, \r\n          {folderpath: this.props.file.folder} as iSocketEventsParams.uploadResourcesInfos) \r\n        this.restartAutomaticHistorySave()\r\n\r\n      }\r\n      return true\r\n    }\r\n\r\n    componentWillUnmount(){\r\n      console.log(`[EDITOR] will unmount ${this.keyUploadSocketListener}`);\r\n      this.onNoteLeaveLogic()\r\n      socketEventsManager.off(this.keyUploadSocketListener)\r\n    }\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n    //\r\n    // FUNCTIONS\r\n    //\r\n\r\n    onNoteLeaveLogic = () => {\r\n      if (this.state.shouldSaveOnLeave) {\r\n        console.log('[EDITOR] ON LEAVING AN EDITED DOCUMENT');\r\n        this.props.onFileEdited(this.props.file.path, this.state.fileContent)\r\n      } else {\r\n        console.log('[EDITOR] ON LEAVING AN UNEDITED DOCUMENT');\r\n      }\r\n\r\n      console.log('ON LEAVE', this.shouldEncryptOnLeave);\r\n      \r\n      if (this.shouldEncryptOnLeave && this.state.password) {\r\n        let res = encryptText(this.state.fileContent, this.state.password)\r\n        if (res.cipher) this.props.onFileEdited(this.props.file.path, res.cipher)\r\n        this.neutralizeDelayedFileSave = true\r\n        setTimeout(() => {this.neutralizeDelayedFileSave = false}, 1000)\r\n      }\r\n\r\n      this.shouldEncryptOnLeave = false\r\n      this.noHistoryBackup = false\r\n    }\r\n\r\n    triggerContentSaveLogic = (newContent:string) => {\r\n      this.setState({fileContent: newContent, shouldSaveOnLeave: true})\r\n      \r\n      if (!this.state.shouldSaveOnLeave && !this.noHistoryBackup) {\r\n        console.log('[EDITOR] ON NEW DOCUMENT EDITION');\r\n        this.props.onSavingHistoryFile(this.props.file.path, newContent, 'enter')\r\n      }\r\n      // let ct = newContent.substr(newContent.length-100, 100)\r\n      // console.log('[EDITOR] ON triggerContentSaveLogic', {ct});\r\n      \r\n      this.throttledOnFileEdited(this.props.file.path, newContent)\r\n      this.debouncedOnFileEdited(this.props.file.path, newContent)\r\n    }\r\n\r\n    historySaveInterval: any\r\n    historyContent: string = ''\r\n    restartAutomaticHistorySave = () => {\r\n      clearInterval(this.historySaveInterval)\r\n      let historySaveInMin = 10 \r\n      let historySaveIntTime = historySaveInMin * 60 * 1000 \r\n      \r\n      this.historySaveInterval = setInterval(() => {\r\n        if (this.noHistoryBackup) return\r\n        if (this.state.fileContent !== this.historyContent) {\r\n          this.historyContent = this.state.fileContent\r\n          console.log(`[EDITOR => HISTORY SAVE CRON] : content changed, saving history version ${this.props.file.path}`);\r\n          this.props.onSavingHistoryFile(this.props.file.path, this.state.fileContent, 'int')\r\n        } else {\r\n          console.log(`[EDITOR => HISTORY SAVE CRON] : content not changed, do nothing`);\r\n        }\r\n      }, historySaveIntTime )\r\n    }\r\n\r\n\r\n\r\n    neutralizeDelayedFileSave: boolean = false\r\n    throttledOnFileEdited = throttle((filePath:string, content:string) => {\r\n      if (this.neutralizeDelayedFileSave) return\r\n      this.props.onFileEdited(filePath, content)\r\n    }, 1000)\r\n    \r\n    debouncedOnFileEdited = debounce((filePath:string, content:string) => {\r\n      if (this.neutralizeDelayedFileSave) return\r\n      this.props.onFileEdited(filePath, content)\r\n    }, 1000)\r\n\r\n    submitOnEnter = (event:any) => {\r\n      if (event.key === 'Enter') {\r\n        if (this.state.filePath.length < 3) return\r\n        this.props.onFilePathEdited(this.props.file.path ,this.state.filePath)\r\n      }\r\n    }\r\n\r\n    editorScrollLogic = (e:any) => {\r\n      let direction = e.deltaY > 0 ? 1 : -1\r\n      let delta = direction * Math.min(Math.abs(e.deltaY),40)\r\n      let newY = this.state.posY + delta\r\n      let previewDivWrapper = this.previewContentWrapper.current \r\n      let previewDiv = this.previewContent.current \r\n      // console.log(previewDiv.offsetHeight, previewDiv.clientHeight);\r\n      \r\n      let monacoHeight = this.monacoEditorComp ? this.monacoEditorComp.current.editor.getContentHeight() : 0\r\n      let maxHeight = Math.max(previewDiv.offsetHeight, monacoHeight)\r\n      \r\n      if (newY > -200 && newY < maxHeight) {\r\n        this.setState({posY: newY})\r\n        previewDivWrapper.scrollTop = newY\r\n      }\r\n    }\r\n\r\n\r\n    // \r\n    // ENCRYPTION FUNCTIONS\r\n    //\r\n    encryptContent = () => {\r\n      if (!this.state.password) return \r\n      let newContent = this.state.fileContent\r\n      let res = encryptText(newContent, this.state.password)\r\n      if (res.status === 'failure') this.setState({password: null})\r\n      else {\r\n        this.shouldEncryptOnLeave = false\r\n        let textEncrypted = res.cipher as string\r\n        this.triggerContentSaveLogic(textEncrypted)\r\n      }\r\n    }\r\n\r\n    noHistoryBackup: boolean = false\r\n    shouldEncryptOnLeave: boolean = false\r\n    decryptContent = () => {\r\n      if (!this.state.password) return \r\n      let newContent = this.state.fileContent\r\n      let res = decryptText(newContent, this.state.password)\r\n      if (res.status === 'failure') {this.setState({password: null}); alert('wrong password')}\r\n      else {\r\n        this.noHistoryBackup = true\r\n        this.shouldEncryptOnLeave = true\r\n        let text = res.plaintext as string\r\n        this.triggerContentSaveLogic(text)\r\n      }\r\n    }\r\n\r\n    //\r\n    // TEXT MANIPULATION ACTIONS \r\n    //\r\n    currentCursorPos:any \r\n    saveCursorPos = (pos:any) => {\r\n      this.currentCursorPos = pos\r\n    }\r\n    getLineTextInfos = ():LineTextInfos => {\r\n      let res:LineTextInfos\r\n      \r\n      if (deviceType() === 'desktop' && this.monacoEditorComp) {\r\n        res = this.monacoEditorComp.getCurrentLineInfos()\r\n        this.currentCursorPos = res.monacoPosition\r\n      } else {\r\n        res = getCurrentLineInfos(this.textareaMobile.current)\r\n        this.currentCursorPos = res.textareaPosition\r\n        this.saveYTextarea()\r\n      }\r\n      return res\r\n    }\r\n    resetCursorPosition = (decal:number) => {\r\n      if (deviceType() === 'desktop' && this.monacoEditorComp) {\r\n        this.monacoEditorComp.editor.setPosition(this.currentCursorPos);\r\n      } else {\r\n        let textarea = this.textareaMobile.current\r\n        textarea.focus()\r\n        setTimeout(()=>{\r\n          textarea.selectionStart = this.currentCursorPos + decal\r\n          textarea.selectionEnd = this.currentCursorPos + decal\r\n          this.resetYTextarea()\r\n        })\r\n      }\r\n    }\r\n    onTextModifAction = (action:TextModifAction) => {\r\n      let newText = triggerTextModifAction(\r\n        action, \r\n        this.getLineTextInfos(),\r\n        charDecal => {\r\n          this.resetCursorPosition(charDecal)\r\n        }\r\n      )\r\n      this.triggerContentSaveLogic(newText)\r\n    }\r\n    \r\n\r\n\r\n    //\r\n    // MOBILE TEXT AREA LOGIC\r\n    //\r\n    onTextareaScroll = (e:any) => {\r\n      if (this.isTextareaEdited) return\r\n      // @ts-ignore\r\n      let y = e.target.scrollTop\r\n      this.saveYTextarea(y)\r\n    }\r\n    onTextareaChange = (e:any) => {\r\n      this.isTextareaEdited = true\r\n      this.debounceTextareaEdited()\r\n      this.resetYTextarea()\r\n      let updatedText = e.target.value\r\n      let newLetter = updatedText[e.target.selectionStart-1].charCodeAt(0)\r\n      // only react on insertion\r\n      if (updatedText.length > this.state.fileContent.length) {\r\n        updatedText = updateTextFromLetterInput (\r\n          this.getLineTextInfos(),\r\n          newLetter,\r\n          decalChars => {\r\n            this.resetCursorPosition(decalChars)\r\n          }  \r\n          )\r\n        }\r\n        this.triggerContentSaveLogic(updatedText); \r\n      }\r\n      \r\n      //keeping scroll position stable\r\n      textareaY:number = 0 \r\n      saveYTextarea = (scrollTop?:number) => {\r\n        this.textareaY = scrollTop ? scrollTop : this.textareaMobile.current.scrollTop\r\n      }\r\n      resetYTextarea = () => {\r\n        this.textareaMobile.current.scrollTop = this.textareaY\r\n      }\r\n      isTextareaEdited: boolean = false\r\n      debounceTextareaEdited = debounce(() => {\r\n        this.isTextareaEdited = false\r\n      }, 500)\r\n      \r\n      \r\n     \r\n      \r\n      \r\n      \r\n      //\r\n      // RENDER\r\n      //\r\n      oldPath: string = ''\r\n      oldContent: string = ''\r\n      render() {\r\n        if (this.oldPath !== this.props.file.path || this.oldContent !== this.props.fileContent) {\r\n          this.setState({\r\n            fileContent: this.props.fileContent,\r\n            filePath: this.props.file.path\r\n          })\r\n          this.oldPath = this.props.file.path\r\n          this.oldContent = this.props.fileContent\r\n        \r\n      }\r\n      let currentFolderArr = this.props.file.path.split('/')\r\n      currentFolderArr.pop()\r\n      let currentFolder = currentFolderArr.join('/')\r\n      return (\r\n        <StyledWrapper>\r\n            {\r\n              //////////////////////////////////////////////////////////////////////////\r\n              // LEFT (EDITOR)\r\n              //////////////////////////////////////////////////////////////////////////\r\n            }\r\n          <div \r\n            className=\"editor\"\r\n            onWheelCapture={this.editorScrollLogic}\r\n            >\r\n\r\n            <div \r\n              className={`dragzone ${this.state.dragzoneEnabled ? '' : 'hidden'}`} \r\n              ref={this.dragzone} >\r\n            </div>\r\n\r\n            {\r\n              /////////////////////////////\r\n              // TOOLBARS\r\n              /////////////////////////////\r\n            }\r\n\r\n            <NoteMobileToolbar\r\n              onButtonClicked={this.onTextModifAction}            \r\n            />\r\n\r\n            <div className='toolbar-wrapper'>\r\n              <ButtonToolbar\r\n                buttons={mainEditorToolbarConfig(this)}\r\n              />\r\n            </div>\r\n\r\n\r\n            {\r\n              /////////////////////////////\r\n              // EDITORS\r\n              /////////////////////////////\r\n            }\r\n            <div className={`editor-area ${this.state.editorEnabled ? 'active' : 'inactive'}`}>\r\n              <div className='title-input-wrapper'>\r\n                <input \r\n                      type=\"text\" \r\n                      value={this.state.filePath}\r\n                      onChange={(e) => {this.setState({filePath: e.target.value})}}\r\n                      onKeyDown={this.submitOnEnter}\r\n                  />\r\n              </div>\r\n              {\r\n                !this.state.reloadEditor && \r\n                deviceType() === 'desktop' && \r\n                <MonacoEditorWrapper\r\n                  value={this.state.fileContent}\r\n                  vimMode={this.state.vimMode}\r\n                  onChange={this.triggerContentSaveLogic}\r\n                  ref={this.monacoEditorComp}\r\n                  posY={this.state.posY}\r\n                  insertUnderCaret={this.state.insertUnderCaret}\r\n                />\r\n              }\r\n              {\r\n                deviceType() !== 'desktop' && \r\n                <textarea\r\n                  className='textarea-editor'\r\n                  ref={this.textareaMobile}\r\n                  value={this.state.fileContent}\r\n                  onScroll={this.onTextareaScroll}\r\n                  onChange={this.onTextareaChange}\r\n                />\r\n              }\r\n            </div>\r\n\r\n\r\n\r\n\r\n            {\r\n              //////////////////////////////////////////////////////////////////////////\r\n              // RIGHT (PREVIEW)\r\n              //////////////////////////////////////////////////////////////////////////\r\n            }\r\n            <div \r\n              className={`preview-area ${this.state.editorEnabled ? 'half' : 'full'}`} \r\n              ref={this.previewContentWrapper}>\r\n              <h3>{this.props.file.name}</h3>\r\n              <br/>\r\n              <div className='date modified'>modified: {formatDateEditor(new Date(this.props.file.modified || 0))}</div>\r\n              <div className='date created'>created: {formatDateEditor(new Date(this.props.file.created || 0))}</div>\r\n              {\r\n                \r\n              }\r\n              <div \r\n                className='preview-content'\r\n                ref={this.previewContent}\r\n                dangerouslySetInnerHTML={{__html:\r\n                marked( \r\n                transformRessourcesInHTML(currentFolder ,\r\n                transformImagesInHTML (currentFolder ,\r\n                transformExtrawurstLinks (\r\n                transformUrlInLinks ( \r\n                  this.state.fileContent)))))}}></div>\r\n\r\n            </div>\r\n\r\n           \r\n              {\r\n                /////////////////////////////\r\n                // POPUPS\r\n                /////////////////////////////\r\n              }\r\n\r\n              {\r\n                this.state.askForPassword &&\r\n                  <PasswordPopup\r\n                    onClose={() => {this.setState({askForPassword: null})}}\r\n                    onSubmit={(password) => {\r\n                      let action = this.state.askForPassword\r\n                      this.setState({password, askForPassword: null})\r\n                      if (action === 'toEncrypt') setTimeout(()=> { this.encryptContent() },100)\r\n                      if (action === 'toDecrypt') setTimeout(()=> { this.decryptContent() },100)\r\n                    }}\r\n                  ></PasswordPopup>\r\n              }\r\n\r\n          </div>\r\n        </StyledWrapper>\r\n      ); \r\n    }\r\n  }\r\n  \r\n  const StyledWrapper  = styled.div`\r\n    \r\n    \r\n  `","export const textToId = (raw:string):string => {\r\n    let res = raw\r\n    res = res.replaceAll('-','')\r\n    res = res.replaceAll('_','')\r\n    res = res.replaceAll(' ','')\r\n    res = res.replaceAll('/','')\r\n    res = res.replaceAll('.md','')\r\n    res = res.toLowerCase()\r\n    return res\r\n}\r\n\r\nexport const safeString = (str:string):string => {\r\n    return str.replace(/[^\\w\\s]/gi, '')\r\n  }","import React from 'react';\r\nimport styled from '@emotion/styled'\r\n\r\nexport class SearchBar extends React.Component<{\r\n    isSearching: boolean\r\n    isListEmpty: boolean\r\n    searchTerm: string\r\n    onSearchTermUpdate: (term:string) => void\r\n    onSearchSubmit: () => void\r\n}, {\r\n    // search: string\r\n}> {\r\n\r\n    constructor(props:any) {\r\n        super(props)\r\n        this.state = {\r\n            search:'',\r\n        }\r\n    }\r\n    submitOnEnter = (event:any) => {\r\n        if (event.key === 'Enter') {\r\n            console.log('do validate')\r\n            if (this.props.searchTerm.length < 3) return\r\n            this.props.onSearchSubmit()\r\n        }\r\n    }\r\n    render() {\r\n      return (\r\n        <>\r\n            <div className=\"search-input\">\r\n                <input \r\n                    type=\"text\" \r\n                    value={this.props.searchTerm}\r\n                    onKeyDown={this.submitOnEnter}\r\n                    onChange={(e) => {\r\n                        this.props.onSearchTermUpdate(e.target.value)\r\n                    }}\r\n                />\r\n                {/* <button onClick={(e) => {\r\n                    if (this.state.search.length < 3) return\r\n                    this.props.onSearchSubmit(this.state.search)\r\n                }}>submit</button> */}\r\n            </div>\r\n            <div className=\"search-status\">\r\n                {this.props.isSearching && 'searching...'}\r\n                {/* {this.props.isListEmpty && 'no result'} */}\r\n            </div>\r\n        </>\r\n      );\r\n    }\r\n  }\r\n  \r\n  const StyledWrapper  = styled.div`\r\n    \r\n  `","import React from 'react';\r\nimport Tree from 'rc-tree';\r\nimport styled from '@emotion/styled'\r\nimport { iFolder } from '../../../shared/types.shared';\r\nimport { iconFolder } from '../managers/icons.manager';\r\n\r\nconst STYLE = `\r\n.rc-tree-child-tree {\r\n  display: block;\r\n}\r\n\r\n.node-motion {\r\n  transition: all .3s;\r\n  overflow-y: hidden;\r\n}\r\n`;\r\n\r\nconst motion = {\r\n  motionName: 'node-motion',\r\n  motionAppear: false,\r\n  onAppearStart: (node:any) => {\r\n    console.log('Start Motion:', node);\r\n    return { height: 0 };\r\n  },\r\n  onAppearActive: (node:any) => ({ height: node.scrollHeight }),\r\n  onLeaveStart: (node:any) => ({ height: node.offsetHeight }),\r\n  onLeaveActive: () => ({ height: 0 }),\r\n};\r\n\r\n\r\nconst LocalStorageMixin = require('react-localstorage');\r\nconst reactMixin = require('react-mixin');\r\n@reactMixin.decorate(LocalStorageMixin)\r\nexport class TreeView extends React.Component<{\r\n  folder: iFolder\r\n  selected: string\r\n  onFolderClicked: (folderPath:string) => void\r\n  onFolderRightClicked: (folderPath:string) => void\r\n},{\r\n  autoExpandParent: boolean\r\n  expandedKeys: string[]\r\n}> {\r\n\r\n  static displayName = 'treeview';\r\n  constructor(props:any) {\r\n    super(props)\r\n    this.state = {\r\n      autoExpandParent: true,\r\n      expandedKeys: []\r\n    }\r\n  }\r\n\r\n  onDragEnter = ({ expandedKeys }:any) => {\r\n    console.log('enter', expandedKeys);\r\n    this.setState({\r\n      expandedKeys,\r\n    });\r\n  };\r\n\r\n\r\n  onExpand = (expandedKeys:any) => {\r\n    console.log('onExpand', expandedKeys);\r\n    this.setState({\r\n      expandedKeys,\r\n      autoExpandParent: false,\r\n    });\r\n  };\r\n\r\n  render() {\r\n    const { expandedKeys } = this.state;\r\n\r\n    return (\r\n        <StyledWrapper>\r\n        <div className=\"draggable-demo\">\r\n            <style dangerouslySetInnerHTML={{ __html: STYLE }} />\r\n            <Tree\r\n              expandedKeys={expandedKeys}\r\n              onExpand={this.onExpand}\r\n              selectedKeys={[this.props.selected]}\r\n              autoExpandParent={this.state.autoExpandParent}\r\n              draggable\r\n              //   onDragStart={this.onDragStart}\r\n              onDragEnter={this.onDragEnter}\r\n              onRightClick={(info) => { \r\n                // @ts-ignore\r\n                let path = info.node.path\r\n                if (!path) return \r\n                this.props.onFolderRightClicked(path)\r\n              }}\r\n              onSelect={(key, info) => { \r\n                this.props.onFolderClicked(info.node.key as string) \r\n              }}\r\n              treeData={[this.props.folder]}\r\n              motion={motion}\r\n            />\r\n        </div>\r\n        </StyledWrapper>\r\n    );\r\n  }\r\n}\r\n\r\n\r\n\r\nconst StyledWrapper  = styled.div`\r\n.rc-tree {\r\n  margin: 0;\r\n  border: 1px solid transparent;\r\n}\r\n.rc-tree-focused:not(.rc-tree-active-focused) {\r\n  border-color: cyan;\r\n}\r\n.rc-tree .rc-tree-treenode {\r\n  margin: 0;\r\n  padding: 0;\r\n  line-height: 24px;\r\n  white-space: nowrap;\r\n  list-style: none;\r\n  outline: 0;\r\n}\r\n.rc-tree .rc-tree-treenode .draggable {\r\n  color: #dddddd;\r\n  -moz-user-select: none;\r\n  -khtml-user-select: none;\r\n  -webkit-user-select: none;\r\n  user-select: none;\r\n  /* Required to make elements draggable in old WebKit */\r\n  -khtml-user-drag: element;\r\n  -webkit-user-drag: element;\r\n}\r\n.rc-tree .rc-tree-treenode.drop-container > .draggable::after {\r\n  position: absolute;\r\n  left: 0;\r\n  right: 0;\r\n  top: 0;\r\n  bottom: 0;\r\n  box-shadow: inset 0 0 0 2px red;\r\n  content: \"\";\r\n}\r\n.rc-tree .rc-tree-treenode.drop-container ~ .rc-tree-treenode {\r\n  border-left: 2px solid chocolate;\r\n}\r\n.rc-tree .rc-tree-treenode.drop-target {\r\n  background-color: yellowgreen;\r\n}\r\n.rc-tree .rc-tree-treenode.drop-target ~ .rc-tree-treenode {\r\n  border-left: none;\r\n}\r\n.rc-tree .rc-tree-treenode.filter-node > .rc-tree-node-content-wrapper {\r\n  color: #a60000 !important;\r\n  font-weight: bold !important;\r\n}\r\n.rc-tree .rc-tree-treenode ul {\r\n  margin: 0;\r\n  padding: 0 0 0 18px;\r\n}\r\n.rc-tree .rc-tree-treenode .rc-tree-node-content-wrapper {\r\n  position: relative;\r\n  display: inline-block;\r\n  height: 24px;\r\n  margin: 0;\r\n  padding: 0;\r\n  text-decoration: none;\r\n  vertical-align: top;\r\n  cursor: pointer;\r\n}\r\n.rc-tree .rc-tree-treenode span.rc-tree-switcher,\r\n.rc-tree .rc-tree-treenode span.rc-tree-checkbox,\r\n.rc-tree .rc-tree-treenode span.rc-tree-iconEle {\r\n  display: inline-block;\r\n  width: 16px;\r\n  height: 16px;\r\n  margin-right: 2px;\r\n  line-height: 16px;\r\n  vertical-align: -0.125em;\r\n  background-color: transparent;\r\n  background-image: url('${iconFolder}');\r\n  background-repeat: no-repeat;\r\n  background-attachment: scroll;\r\n  border: 0 none;\r\n  outline: none;\r\n  cursor: pointer;\r\n}\r\n.rc-tree .rc-tree-treenode span.rc-tree-switcher.rc-tree-icon__customize,\r\n.rc-tree .rc-tree-treenode span.rc-tree-checkbox.rc-tree-icon__customize,\r\n.rc-tree .rc-tree-treenode span.rc-tree-iconEle.rc-tree-icon__customize {\r\n  background-image: none;\r\n}\r\n.rc-tree .rc-tree-treenode span.rc-tree-icon_loading {\r\n  margin-right: 2px;\r\n  vertical-align: top;\r\n  background: url('data:image/gif;base64,R0lGODlhEAAQAKIGAMLY8YSx5HOm4Mjc88/g9Ofw+v///wAAACH/C05FVFNDQVBFMi4wAwEAAAAh+QQFCgAGACwAAAAAEAAQAAADMGi6RbUwGjKIXCAA016PgRBElAVlG/RdLOO0X9nK61W39qvqiwz5Ls/rRqrggsdkAgAh+QQFCgAGACwCAAAABwAFAAADD2hqELAmiFBIYY4MAutdCQAh+QQFCgAGACwGAAAABwAFAAADD1hU1kaDOKMYCGAGEeYFCQAh+QQFCgAGACwKAAIABQAHAAADEFhUZjSkKdZqBQG0IELDQAIAIfkEBQoABgAsCgAGAAUABwAAAxBoVlRKgyjmlAIBqCDCzUoCACH5BAUKAAYALAYACgAHAAUAAAMPaGpFtYYMAgJgLogA610JACH5BAUKAAYALAIACgAHAAUAAAMPCAHWFiI4o1ghZZJB5i0JACH5BAUKAAYALAAABgAFAAcAAAMQCAFmIaEp1motpDQySMNFAgA7') no-repeat scroll 0 0 transparent;\r\n}\r\n.rc-tree .rc-tree-treenode span.rc-tree-switcher.rc-tree-switcher-noop {\r\n  cursor: auto;\r\n}\r\n.rc-tree .rc-tree-treenode span.rc-tree-switcher.rc-tree-switcher_open {\r\n  background-position: -93px -56px;\r\n}\r\n.rc-tree .rc-tree-treenode span.rc-tree-switcher.rc-tree-switcher_close {\r\n  background-position: -75px -56px;\r\n}\r\n.rc-tree .rc-tree-treenode span.rc-tree-checkbox {\r\n  width: 13px;\r\n  height: 13px;\r\n  margin: 0 3px;\r\n  background-position: 0 0;\r\n}\r\n.rc-tree .rc-tree-treenode span.rc-tree-checkbox-checked {\r\n  background-position: -14px 0;\r\n}\r\n.rc-tree .rc-tree-treenode span.rc-tree-checkbox-indeterminate {\r\n  background-position: -14px -28px;\r\n}\r\n.rc-tree .rc-tree-treenode span.rc-tree-checkbox-disabled {\r\n  background-position: 0 -56px;\r\n}\r\n.rc-tree .rc-tree-treenode span.rc-tree-checkbox.rc-tree-checkbox-checked.rc-tree-checkbox-disabled {\r\n  background-position: -14px -56px;\r\n}\r\n.rc-tree .rc-tree-treenode span.rc-tree-checkbox.rc-tree-checkbox-indeterminate.rc-tree-checkbox-disabled {\r\n  position: relative;\r\n  background: #ccc;\r\n  border-radius: 3px;\r\n}\r\n.rc-tree .rc-tree-treenode span.rc-tree-checkbox.rc-tree-checkbox-indeterminate.rc-tree-checkbox-disabled::after {\r\n  position: absolute;\r\n  top: 5px;\r\n  left: 3px;\r\n  width: 5px;\r\n  height: 0;\r\n  border: 2px solid #fff;\r\n  border-top: 0;\r\n  border-left: 0;\r\n  -webkit-transform: scale(1);\r\n  transform: scale(1);\r\n  content: ' ';\r\n}\r\n.rc-tree:not(.rc-tree-show-line) .rc-tree-treenode .rc-tree-switcher-noop {\r\n  background: none;\r\n}\r\n.rc-tree.rc-tree-show-line .rc-tree-treenode:not(:last-child) > ul {\r\n  background: url('data:image/gif;base64,R0lGODlhCQACAIAAAMzMzP///yH5BAEAAAEALAAAAAAJAAIAAAIEjI9pUAA7') 0 0 repeat-y;\r\n}\r\n.rc-tree.rc-tree-show-line .rc-tree-treenode:not(:last-child) > .rc-tree-switcher-noop {\r\n  background-position: -56px -18px;\r\n}\r\n.rc-tree.rc-tree-show-line .rc-tree-treenode:last-child > .rc-tree-switcher-noop {\r\n  background-position: -56px -36px;\r\n}\r\n.rc-tree-child-tree {\r\n  display: none;\r\n}\r\n.rc-tree-child-tree-open {\r\n  display: block;\r\n}\r\n.rc-tree-treenode-disabled > span:not(.rc-tree-switcher),\r\n.rc-tree-treenode-disabled > a,\r\n.rc-tree-treenode-disabled > a span {\r\n  color: #767676;\r\n  cursor: not-allowed;\r\n}\r\n.rc-tree-treenode-active {\r\n  background: rgba(0, 0, 0, 0.1);\r\n}\r\n.rc-tree-node-selected {\r\n  /* background-color: #ffe6b0; */\r\n  /* padding:  */\r\n  /* box-shadow: 0 0 0 1px #ffb951; */\r\n  opacity: 0.8;\r\n  background: rgba(255,255,255,0.2);\r\n}\r\n.rc-tree-icon__open {\r\n  margin-right: 2px;\r\n  vertical-align: top;\r\n  background-position: -110px -16px;\r\n}\r\n.rc-tree-icon__close {\r\n  margin-right: 2px;\r\n  vertical-align: top;\r\n  background-position: -110px 0;\r\n}\r\n.rc-tree-icon__docu {\r\n  margin-right: 2px;\r\n  vertical-align: top;\r\n  background-position: -110px 0px;\r\n}\r\n.rc-tree-icon__customize {\r\n  margin-right: 2px;\r\n  vertical-align: top;\r\n}\r\n.rc-tree-title {\r\n  display: inline-block;\r\n}\r\n.rc-tree-indent {\r\n  display: inline-block;\r\n  vertical-align: bottom;\r\n  height: 0;\r\n}\r\n.rc-tree-indent-unit {\r\n  width: 16px;\r\n  display: inline-block;\r\n}\r\n\r\n`","export const iconFolder = `data:image/png;base64,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`","type KeyName = 'up' | 'down' | 'ctrl' | 'shift' | 'alt' | 'enter'\r\n\r\nexport const onKey = (e:any, keyName:KeyName, action:Function) => {\r\n    e = e || window.event;\r\n    let codes:{[key in KeyName]:number} = {\r\n        up: 38,\r\n        down: 40,\r\n        ctrl: 17,\r\n        shift: 16,\r\n        alt: 18,\r\n        enter: 13,\r\n    }\r\n    if (e.keyCode === codes[keyName]) {\r\n        action()\r\n    }\r\n}\r\n\r\n\r\n\r\n\r\n// export const listenOnEnter = (el:HTMLElement) => {\r\n//     el.addEventListener('keydown', handleOnEnter)\r\n// }\r\n// export const stopListenOnEnter = (el:HTMLElement) => {\r\n//     el.removeEventListener('keydown', handleOnEnter)\r\n// }\r\n\r\n\r\n// export const initKeysLogic = ","import { isNumber } from \"lodash\";\r\n\r\nexport interface iUrlParams {\r\n    search?:string\r\n    folder?:string\r\n    file?:number\r\n}\r\nlet currentUrlParams:any = {}\r\n\r\nexport const listenToUrlChanges = (p:{\r\n    onUrlParamsChange:(urlParams:iUrlParams)=>void, \r\n    // onHashChange:(searchTerm:string)=>void\r\n}) => {\r\n    // window.onhashchange = () => { \r\n    //     let hash = window.location.hash.substr(1)\r\n    //     hash = decodeURI(hash)\r\n    //     if (hash.length > 0) {\r\n    //         console.log(`[HASH CHANGE]`, hash)\r\n    //         if (hash.startsWith('search[')) {\r\n    //         let searchTerm = hash.replaceAll('search[','').replaceAll(']','').replaceAll('_','-')\r\n    //         p.onHashChange(searchTerm)\r\n    //       }\r\n    //     }\r\n    //     window.location.hash = ''\r\n    // }\r\n\r\n    //@ts-ignore\r\n    window.log2 = console.log\r\n   \r\n    \r\n    window.onpopstate  = () => { \r\n        let newUrlParams = getUrlParams()\r\n        // console.log('ONPOPSTATE DETECTED'); \r\n        // console.log(JSON.stringify(newUrlParams),JSON.stringify(currentUrlParams)); \r\n        \r\n        if (JSON.stringify(newUrlParams) === JSON.stringify(currentUrlParams)) return\r\n        currentUrlParams = newUrlParams\r\n        // console.log('11 pop',currentUrlParams);\r\n        console.log('[URL CHANGE DETECTED]', newUrlParams);\r\n        p.onUrlParamsChange(newUrlParams)\r\n    }\r\n}\r\n\r\nexport const getUrlParams = ():iUrlParams => {\r\n    let urlParams:iUrlParams = {}\r\n    const queryString = window.location.search;\r\n    const urlParamsSearch = new URLSearchParams(queryString);\r\n    urlParams.search = urlParamsSearch.get('search') || undefined\r\n    urlParams.file = urlParamsSearch.get('file') ? parseInt(urlParamsSearch.get('file') as string) : undefined\r\n    urlParams.folder = urlParamsSearch.get('folder') || undefined\r\n    // console.log('[READING URL PARAMS]', urlParams);\r\n    return urlParams\r\n}\r\n\r\nexport const updateUrl = (urlParams:iUrlParams) => {\r\n    \r\n\r\n    let newUrl = `${window.location.protocol}//${window.location.host}/?`\r\n    if (isNumber(urlParams.file) && urlParams.file !== -1) newUrl += `file=${urlParams.file}&`\r\n\r\n    if (urlParams.folder && urlParams.folder !== ''  && !urlParams.search) newUrl += `folder=${urlParams.folder}&`\r\n\r\n    if (!urlParams.folder && !urlParams.search) newUrl += `folder=/&`\r\n\r\n    if (urlParams.search && urlParams.search !== '') newUrl += `search=${urlParams.search}&`\r\n\r\n    window.history.pushState({},document.title, newUrl)\r\n\r\n    currentUrlParams = getUrlParams()\r\n    // console.log('12 updateurl', currentUrlParams);\r\n}","import React from 'react';\r\n\r\nimport { iSocketEventsParams, socketEvents } from '../../shared/sockets/sockets.events';\r\nimport { clientSocket, initSocketConnection } from './managers/sockets/socket.manager';\r\nimport { bindEventManagerToSocketEvents, socketEventsManager } from './managers/sockets/eventsListener.sockets';\r\nimport { iFile, iFolder } from '../../shared/types.shared';\r\nimport { List, SortModes, SortModesLabels } from './components/List.component';\r\nimport { Note } from './components/note/Note.component';\r\nimport { SearchBar } from './components/SearchBar.component';\r\nimport { TreeView } from './components/TreeView.Component';\r\nimport { Global } from '@emotion/react'\r\nimport { CssApp, GlobalCssApp } from './managers/style.manager';\r\nimport { onKey } from './managers/keys.manager';\r\nimport { configClient } from './config';\r\nimport { debounce, filter, isNumber, sortBy } from 'lodash';\r\nimport { Icon } from './components/Icon.component';\r\nimport { getUrlParams, listenToUrlChanges, updateUrl, iUrlParams } from './managers/url.manager';\r\nimport { initClipboardListener } from './managers/clipboard.manager';\r\nimport { deviceType, MobileView } from './managers/device.manager';\r\nimport { Note2 } from './components/note/Note2.component';\r\n\r\n\r\nconst LocalStorageMixin = require('react-localstorage');\r\nconst reactMixin = require('react-mixin');\r\n@reactMixin.decorate(LocalStorageMixin)\r\nclass App extends React.Component<{\r\n}, {\r\n  files:iFile[], \r\n  activeFileIndex: number\r\n  activeFileContent: string | null\r\n  selectedFolder: string\r\n  searchTerm: string\r\n  isSearching: boolean\r\n  folderHierarchy: iFolder \r\n  hoverMode: boolean \r\n  ctrlPressed: boolean \r\n  multiSelectMode: boolean \r\n  multiSelectArray: number[] \r\n  sortMode: number\r\n  mobileView: MobileView\r\n  isSocketConnected: boolean\r\n}> {\r\n\r\n  static displayName = 'extrawurstApp';\r\n  constructor(props:any) {\r\n      super(props)\r\n      this.state = {\r\n        files: [],\r\n        folderHierarchy: {title: '', key: '', path: ''},\r\n        activeFileIndex: -1,\r\n        selectedFolder: '',\r\n        searchTerm: '',\r\n        activeFileContent: null,\r\n        isSearching: false,\r\n        ctrlPressed: false,\r\n        hoverMode: false,\r\n        multiSelectMode: false,\r\n        sortMode: 0,\r\n        multiSelectArray: [],\r\n        mobileView:'navigator', \r\n        isSocketConnected: false\r\n      }\r\n  }\r\n  listenerIds:number[] = []\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n  ////////////////////////////////////////////////////////////////////////////////\r\n  //  LIFECYCLE EVENTS\r\n  //////////////////////////////////////////////////////////////////////////////// \r\n  componentDidMount() {\r\n    console.log(`[APP] MOUNTED on a ${deviceType()}`);\r\n    this.toggleSocketConnection(false)\r\n    this.updatePageTitle()\r\n\r\n    // initClipboardListener()\r\n\r\n    this.initKeyboardShortcuts()\r\n\r\n    \r\n    initSocketConnection().then(() => {\r\n      this.toggleSocketConnection(true)\r\n\r\n      this.initUrlParamsLogic()\r\n\r\n      this.initSearchForContentLinks()\r\n\r\n      bindEventManagerToSocketEvents()\r\n      \r\n      // INITIAL REQUESTS (including a folder scan every minute)\r\n      setInterval(() => {\r\n        // this.askForFolderScan()\r\n      }, 1000 * 60)\r\n\r\n      // reload file details \r\n      this.state.activeFileIndex !== -1 && this.loadFileDetails(this.state.activeFileIndex)\r\n      this.askForFolderScan()\r\n      this.setState({ctrlPressed: false})\r\n\r\n      this.lastFolderIn = this.state.selectedFolder\r\n      this.lastSearchIn = this.state.searchTerm\r\n      this.listenerIds[0] = socketEventsManager.on(\r\n        socketEvents.getFiles, \r\n        (data:iSocketEventsParams.getFiles) => {  \r\n          this.onFolderFilesReceived(data)\r\n      })\r\n\r\n      this.listenerIds[1] = socketEventsManager.on(\r\n        socketEvents.getFileContent, \r\n        (data:iSocketEventsParams.getFileContent) => {   \r\n          let activeFile = this.state.files[this.state.activeFileIndex]\r\n          if (data.filePath !== activeFile.path) return\r\n          this.setState({activeFileContent: data.fileContent})\r\n      })\r\n\r\n      this.listenerIds[2] = socketEventsManager.on(\r\n        socketEvents.getFolderHierarchy, \r\n        (data:iSocketEventsParams.getFolderHierarchy) => {  \r\n          this.setState({folderHierarchy: data.folder})\r\n      })\r\n\r\n      this.listenerIds[3] = socketEventsManager.on(socketEvents.disconnect, () => { this.toggleSocketConnection(false) })\r\n      this.listenerIds[4] = socketEventsManager.on(socketEvents.reconnect, () => {this.toggleSocketConnection(true) })\r\n      this.listenerIds[5] = socketEventsManager.on(socketEvents.connect, () => {this.toggleSocketConnection(true) })\r\n  })\r\n}\r\n\r\n\r\n\r\n  componentDidUpdate(prevProps:any, prevState:any) {\r\n    if (prevState.files !== this.state.files) {\r\n      if (this.state.activeFileIndex !== -1) {\r\n        this.loadFileDetails(this.state.activeFileIndex)\r\n      }\r\n    }\r\n    \r\n    // URL : check if folder/fileIndex/searchTerm changes, if yes, change URL accordingly\r\n    if (\r\n      prevState.activeFileIndex !== this.state.activeFileIndex ||\r\n      prevState.selectedFolder !== this.state.selectedFolder || \r\n      prevState.isSearching !== this.state.isSearching\r\n    ) this.updateAppUrl()\r\n  }\r\n\r\n  componentWillUnmount(){\r\n    this.listenerIds.forEach((id) => {\r\n      socketEventsManager.off(id)\r\n    })\r\n  }\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n  ////////////////////////////////////////////////////////////////////////////////\r\n  //  SUPPORT FUNCTIONS\r\n  ////////////////////////////////////////////////////////////////////////////////\r\n  intPageBlink:any\r\n  updatePageTitle = () => {\r\n    \r\n    let generateTitle = ():string => {\r\n      let newTitle = ''\r\n      if (window.location.host.includes(configClient.global.frontendPort.toString())) newTitle =  `Extrawurst (PROD ${configClient.version})`\r\n      else newTitle = `/!\\\\ DEV /!\\\\`\r\n      return newTitle\r\n    }\r\n  \r\n    let title\r\n    clearInterval(this.intPageBlink)\r\n    if (this.state.isSocketConnected) {\r\n       title =  `${generateTitle()} (Connected)`\r\n       console.log(13);\r\n    } else {\r\n      console.log(12);\r\n      \r\n      let warning1 = '(DISCONNECTED)'\r\n      let warning2 = '(/!\\\\ DISCONNECTED /!\\\\)'\r\n      let warning = warning1\r\n      title = `${generateTitle()} ${warning}`\r\n      this.intPageBlink = setInterval(() => {\r\n        warning = (warning === warning1) ? warning2 : warning1\r\n        title = `${generateTitle()} ${warning}`\r\n        document.title = title\r\n      }, 1000)\r\n    }\r\n    \r\n    document.title = title\r\n  }\r\n  \r\n    toggleSocketConnection = (state: boolean) => {\r\n      console.log(`[SOCKET CONNECTION TOGGLE] to ${state}`);\r\n      this.setState({isSocketConnected: state}) \r\n      setTimeout(() => {this.updatePageTitle()}, 100)\r\n    }\r\n  \r\n    toggleMobileView = (mobileView:MobileView) => {\r\n      // let mobileView:MobileView = this.state.mobileView === 'editor' ? 'navigator' : 'editor'\r\n      this.setState({mobileView})\r\n    }\r\n    \r\n    cleanFilesList = () => {\r\n      this.setState({files: []})\r\n    }\r\n    askForFolderFiles = (folderPath:string) => {\r\n      clientSocket.emit(socketEvents.askForFiles, {folderPath: folderPath} as iSocketEventsParams.askForFiles)\r\n    }\r\n    cleanAndAskForFolderFiles = (folderPath:string) => {\r\n      this.setState({isSearching: true})\r\n      this.cleanFilesList()\r\n      this.askForFolderFiles(folderPath)\r\n    }\r\n    askForFolderScan = () => {\r\n      clientSocket.emit(socketEvents.askFolderHierarchy, {folderPath: ''} as iSocketEventsParams.askFolderHierarchy)  \r\n    }\r\n  \r\n    moveFile = (initPath:string, endPath:string) => {\r\n      console.log(`[MOVEFILE] ${initPath} -> ${endPath}`);\r\n      clientSocket.emit(socketEvents.moveFile, {initPath, endPath, shouldRescan: true} as iSocketEventsParams.moveFile)  \r\n    }\r\n  \r\n    promptAndBatchMoveFiles = (folderpath:string) => {\r\n      let userAccepts = window.confirm(`Are you sure you want to move ${this.state.multiSelectArray.length} files and their resources to ${folderpath}`)\r\n      if (userAccepts) {\r\n        for (let i = 0; i < this.state.multiSelectArray.length; i++) {\r\n          const fileId = this.state.multiSelectArray[i];\r\n          let file = this.state.files[fileId]\r\n          let filenameArr = file.name.split('/')\r\n          // in case we are in research, the file.name === file.path\r\n          let realFileName = filenameArr[filenameArr.length-1]\r\n          this.moveFile(file.path, `${folderpath}/${realFileName}`)\r\n        }\r\n        this.cleanMultiSelect() \r\n        this.emptyFileDetails()\r\n      }\r\n    }\r\n    \r\n    \r\n  \r\n    sortFiles = (files:iFile[], sortMode:any):iFile[] => {\r\n      let sortedFiles\r\n      switch (SortModes[sortMode]) {\r\n        case 'none':\r\n          sortedFiles = sortBy(files, ['index'])\r\n          break;\r\n        case 'alphabetical':\r\n          sortedFiles = sortBy(files, [file => file.realname.toLocaleLowerCase()])\r\n          break;\r\n        case 'created':\r\n          sortedFiles = sortBy(files, ['created']).reverse()\r\n          break;\r\n        case 'modified':\r\n          sortedFiles = sortBy(files, ['modified']).reverse()\r\n          break;\r\n      \r\n        default:\r\n          sortedFiles = sortBy(files, ['index'])\r\n          break;\r\n      }\r\n  \r\n      return sortedFiles\r\n    }\r\n  \r\n    cleanMultiSelect = () => {\r\n      this.setState({ multiSelectMode: false, multiSelectArray: [] })\r\n    }\r\n  \r\n    emptyFileDetails = () => {\r\n      this.setState({activeFileIndex:-1, activeFileContent: null})\r\n    }\r\n  \r\n    loadFileDetails = (fileIndex:number) => {\r\n      console.log('loadfiledetails');\r\n      \r\n      let file = this.state.files[fileIndex]\r\n      \r\n      if (file && file.name.endsWith('.md')) {\r\n        this.setState({activeFileIndex:fileIndex, activeFileContent: null})\r\n        clientSocket.emit(socketEvents.askForFileContent, \r\n          {filePath: file.path} as iSocketEventsParams.askForFileContent)  \r\n      }\r\n    }\r\n\r\n\r\n\r\n\r\n\r\n  //////////////////////////////////////////////\r\n  //  KEYBOARD \r\n  //\r\n  initKeyboardShortcuts = () => {\r\n    window.onkeydown = (e:any) => {\r\n      onKey(e, 'up', () => {\r\n        let i = this.state.activeFileIndex  \r\n        if (i > 0) this.loadFileDetails(i-1)    \r\n      })\r\n      onKey(e, 'down', () => {\r\n        let i = this.state.activeFileIndex  \r\n        if (i < this.state.files.length - 1) this.loadFileDetails(i+1)   \r\n      })\r\n      onKey(e, 'ctrl', () => {\r\n        this.setState({ctrlPressed: true})\r\n      })\r\n    }\r\n    window.onkeyup = (e:any) => {\r\n      onKey(e, 'ctrl', () => {\r\n        this.setState({ctrlPressed: false})\r\n      })\r\n    }\r\n  }\r\n\r\n\r\n  //////////////////////////////////////////////\r\n  //  FOLDER LIST LOGIC\r\n  //\r\n  lastFolderIn:string = ''\r\n  lastSearchIn:string = ''\r\n  shouldLoadFirstNote: boolean = false\r\n  onFolderFilesReceived = (data:iSocketEventsParams.getFiles) => {\r\n    // only keep md files in file list\r\n    let files = filter(data.files, {extension: 'md'})\r\n\r\n    // sort them\r\n    files = this.sortFiles(files, this.state.sortMode)\r\n\r\n    this.setState({\r\n      files,\r\n      isSearching: data.temporaryResults ? true : false\r\n    })\r\n\r\n    // if activeFileIndex exists + is in length of files, load it\r\n    if (this.state.activeFileIndex !== -1 && this.state.activeFileIndex < files.length) {\r\n      this.loadFileDetails(this.state.activeFileIndex)\r\n    }\r\n\r\n    setTimeout(() => {\r\n      if (this.shouldLoadFirstNote) {\r\n        console.log(11, files.length);\r\n        \r\n        files.length >= 1 && this.loadFileDetails(0)\r\n        this.shouldLoadFirstNote = false\r\n      }\r\n      // ON LIST ITEMS CHANGES\r\n      if (this.state.selectedFolder !== this.lastFolderIn || this.state.searchTerm !== this.lastSearchIn) {\r\n        \r\n        // Load first item list \r\n        files.length >= 1 && this.loadFileDetails(0)\r\n        console.log(12, files.length);\r\n        this.lastFolderIn = this.state.selectedFolder\r\n        this.lastSearchIn = this.state.searchTerm\r\n        \r\n        // clean multiselect\r\n        this.cleanMultiSelect()\r\n      }\r\n    }, 100)\r\n  }\r\n\r\n\r\n  //////////////////////////////////////////////\r\n  //  SEARCH LOGIC\r\n  //\r\n  initSearchForContentLinks = () => {\r\n    //@ts-ignore\r\n    window.ewTriggerSearch = (term:string) => {\r\n      console.log(`[SEARCH FROM LINK] for ${term}`);\r\n      term = term.replaceAll('_','-')\r\n      this.triggerSearch(term)\r\n    }\r\n  }\r\n\r\n  triggerSearch = (term:string) => {\r\n    console.log(`[APP -> TRIGGER SEARCH] ${term}`);\r\n    this.emptyFileDetails()\r\n    this.cleanFilesList()\r\n    this.cleanMultiSelect()\r\n    this.setState({ searchTerm: term, isSearching: true, selectedFolder: '', activeFileIndex: -1 })\r\n    clientSocket.emit(socketEvents.searchFor, {term} as iSocketEventsParams.searchFor) \r\n  }\r\n\r\n\r\n  //////////////////////////////////////////////\r\n  //  URL LOGIC\r\n  //\r\n\r\n  // ignore the first url change when page finishes loading\r\n  ignoreNextUrlChange:boolean = false\r\n\r\n  updateAppUrl = debounce(() => {\r\n    if (this.ignoreNextUrlChange) return this.ignoreNextUrlChange = false\r\n    console.log('[UPDATE APP URL]');\r\n    updateUrl ({\r\n      file: this.state.activeFileIndex, \r\n      folder: this.state.selectedFolder, \r\n      search: this.state.searchTerm\r\n    })\r\n  }, 200)\r\n\r\n  initUrlParamsLogic = () => {\r\n\r\n    // do a initial reading when finished loading\r\n    let newUrlParams = getUrlParams()\r\n    this.reactToUrlParams(newUrlParams)\r\n\r\n    listenToUrlChanges({\r\n      onUrlParamsChange: (newUrlParams) => {\r\n        // ignore url change due to state change from reaction of initial url change :S\r\n        this.ignoreNextUrlChange = true\r\n        this.reactToUrlParams(newUrlParams)\r\n      },\r\n    })\r\n  }\r\n\r\n  reactToUrlParams = (newUrlParams:iUrlParams) => {\r\n    if (newUrlParams.folder) {\r\n      console.log(110);\r\n      \r\n      let activeFileIndex = isNumber(newUrlParams.file) ? newUrlParams.file : -1\r\n      this.setState({selectedFolder: newUrlParams.folder, activeFileIndex, searchTerm: ''})\r\n      this.askForFolderFiles(newUrlParams.folder)\r\n    }\r\n    if (newUrlParams.search) {\r\n      console.log('reactToUrlParams -> triggersearch');\r\n      \r\n       this.triggerSearch(newUrlParams.search)\r\n    }\r\n  }\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n  ////////////////////////////////////////////////////////////////////////////////\r\n  //  RENDERING\r\n  ////////////////////////////////////////////////////////////////////////////////\r\n  render() { \r\n    return (\r\n      <CssApp v={this.state.mobileView} >\r\n        <Global styles={GlobalCssApp}  />\r\n        \r\n        <div className=\"main-wrapper\">\r\n              <div className=\"connection-status\">\r\n                  {this.state.isSocketConnected ? <div className=\"connected\">connected</div> : <div className=\"disconnected\">/!\\ DISCONNECTED /!\\</div>}\r\n              </div>\r\n\r\n            { \r\n              deviceType() !== 'desktop' &&\r\n              <div className='mobile-view-toggler'>\r\n                <button \r\n                  type=\"button\" \r\n                  onClick={(e) => { this.toggleMobileView('navigator')}}>\r\n                  Nav</button>\r\n                <button \r\n                  type=\"button\" \r\n                  onClick={(e) => { this.toggleMobileView('editor')}}>\r\n                  Edi</button>\r\n                <button \r\n                  type=\"button\" \r\n                  onClick={(e) => { this.toggleMobileView('preview')}}>\r\n                  Prev</button>\r\n                \r\n              </div>\r\n            }\r\n\r\n\r\n          <div className=\"left-wrapper\">\r\n\r\n            {\r\n              /////////////////////////////\r\n              // TREE\r\n              /////////////////////////////\r\n            }\r\n            <div className=\"left-wrapper-1\">\r\n              <TreeView \r\n                selected={this.state.selectedFolder}\r\n                folder={this.state.folderHierarchy}\r\n                onFolderClicked={(folderpath) => {\r\n                  // if multiselect not empty, prompt user, then move files into that\r\n                  if (this.state.multiSelectMode && this.state.multiSelectArray.length > 0) {\r\n                    this.promptAndBatchMoveFiles(folderpath)\r\n                  } else {\r\n                    // move from selected folder\r\n                    this.shouldLoadFirstNote = true\r\n                    this.setState({selectedFolder: folderpath, searchTerm:'', activeFileIndex: -1})\r\n                    this.cleanAndAskForFolderFiles(folderpath)\r\n                  }\r\n                }}\r\n                onFolderRightClicked = {(folderpath) => {\r\n                  clientSocket.emit(socketEvents.askForExplorer, \r\n                    {folderpath: folderpath} as iSocketEventsParams.askForExplorer) \r\n                }}\r\n              />\r\n\r\n              \r\n            </div>\r\n\r\n            {\r\n              /////////////////////////////\r\n              // SEARCH\r\n              /////////////////////////////\r\n            }\r\n            <div className=\"left-wrapper-2\">\r\n              <SearchBar \r\n                onSearchSubmit={() => {\r\n                    this.triggerSearch(this.state.searchTerm)\r\n                }}\r\n                onSearchTermUpdate={searchTerm => {this.setState({ searchTerm})}}\r\n                searchTerm={this.state.searchTerm}\r\n                isSearching={this.state.isSearching}\r\n                isListEmpty={this.state.files.length === 0 ? true : false}\r\n              />\r\n\r\n\r\n            <div className='list-toolbar'>\r\n            \r\n              { this.state.searchTerm === '' &&\r\n                <button onClick={(e) => {\r\n                    clientSocket.emit(socketEvents.createNote, \r\n                      {folderPath: this.state.selectedFolder} as iSocketEventsParams.createNote) \r\n                    this.setState({activeFileIndex: 0})\r\n                }}><Icon name=\"faStickyNote\" /></button>\r\n              }\r\n\r\n                {/* <input \r\n                  type=\"button\" \r\n                  value={this.state.hoverMode ? 'Hover:On' : 'Hover:Off'} \r\n                  onClick={e => this.setState({hoverMode: !this.state.hoverMode})}\r\n                /> */}\r\n\r\n                <button \r\n                  type=\"button\" \r\n                  title={this.state.multiSelectMode ? 'Select:On' : 'Select:Off'}\r\n                  onClick={e => this.setState({\r\n                    multiSelectMode: !this.state.multiSelectMode,\r\n                    multiSelectArray: []\r\n                  })}\r\n                > <Icon name=\"faCheckDouble\" /> </button>\r\n\r\n                <button \r\n                  type=\"button\" \r\n                  title='sort'\r\n                  onClick={e => {\r\n                    let newMode = this.state.sortMode + 1 >= SortModes.length ? 0 : this.state.sortMode + 1\r\n                    let files = this.sortFiles(this.state.files, newMode)\r\n                    this.setState({sortMode: newMode, files})\r\n                  }}\r\n                > <Icon name=\"faSort\" /> { this.state.sortMode !== 0 && SortModesLabels[this.state.sortMode] } </button>\r\n\r\n              { this.state.files.length > 0 &&\r\n                  <span className='items-list-count'>{this.state.files.length} els</span>\r\n              }\r\n\r\n            </div>\r\n\r\n\r\n\r\n              {\r\n              /////////////////////////////\r\n              // LIST\r\n              /////////////////////////////\r\n              }\r\n              <div className=\"list-wrapper\">\r\n                <List \r\n                  files={this.state.files} \r\n                  hoverMode={this.state.hoverMode}\r\n                  activeFileIndex={this.state.activeFileIndex}\r\n                  ctrlPressed={this.state.ctrlPressed}\r\n\r\n                  sortMode={this.state.sortMode}\r\n\r\n                  multiSelectArray={this.state.multiSelectArray}\r\n                  multiSelectMode={this.state.multiSelectMode}\r\n                  onMultiSelectChange={arr => this.setState({multiSelectArray:arr})}\r\n\r\n                  onFileClicked={(fileIndex) => {\r\n                    this.loadFileDetails(fileIndex)\r\n                  }}\r\n                  />\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n\r\n\r\n\r\n\r\n          {\r\n          /////////////////////////////\r\n          // EDITOR NOTE DETAILS\r\n          /////////////////////////////\r\n          }\r\n          <div className=\"right-wrapper\">\r\n            <div className=\"note-wrapper\">\r\n              { \r\n                (this.state.activeFileIndex !== -1 && this.state.files[this.state.activeFileIndex]) && \r\n                  < Note \r\n                  // <Note2\r\n                    file={this.state.files[this.state.activeFileIndex]} \r\n                    fileContent={this.state.activeFileContent ? this.state.activeFileContent : ''} \r\n                    onFileEdited={(filepath, content) => {\r\n                      console.log(`[APP] API -> ask for file save`,{filepath, content});\r\n                      // this.askForFolderFiles(this.state.selectedFolder)\r\n                      clientSocket.emit(socketEvents.saveFileContent, \r\n                        {filepath: filepath, newFileContent: content} as iSocketEventsParams.saveFileContent)  \r\n                    }}\r\n                    onFilePathEdited={(initPath, endPath) => {\r\n                      console.log(`[APP] onFilePathEdited =>`,{initPath, endPath});\r\n                      this.emptyFileDetails()\r\n                      this.moveFile(initPath, endPath)\r\n                      this.setState({activeFileIndex: 0})\r\n                    }}\r\n                    onSavingHistoryFile={(filePath, content, historyFileType) => {\r\n                      console.log(`[APP] onSavingHistoryFile ${historyFileType} => ${filePath}`);\r\n                      clientSocket.emit(socketEvents.createHistoryFile, \r\n                        {filePath, content, historyFileType} as iSocketEventsParams.createHistoryFile)  \r\n                    }}\r\n                    onEditorDetached={(filepath) => {\r\n                      clientSocket.emit(socketEvents.askForNotepad, \r\n                        {filepath} as iSocketEventsParams.askForNotepad) \r\n\r\n                        setTimeout(() => {\r\n                          this.emptyFileDetails()\r\n                        }, 500)\r\n                    }}\r\n                    onFileDelete={(filepath) => {\r\n                      console.log(`[APP] onFileDelete => ${filepath}`);\r\n                      \r\n                      let i = this.state.activeFileIndex  \r\n                      if (i > 0) this.loadFileDetails(i-1)    \r\n                      else if (i < this.state.files.length - 2) this.loadFileDetails(i+1)   \r\n                      else this.emptyFileDetails()\r\n                      \r\n                      clientSocket.emit(socketEvents.onFileDelete, \r\n                        {filepath} as iSocketEventsParams.onFileDelete) \r\n                        \r\n                      this.askForFolderFiles(this.state.selectedFolder)\r\n                    }}\r\n                  />\r\n              }\r\n              { \r\n                this.state.activeFileIndex === -1 && \r\n                  <div>no file selected</div>\r\n              }\r\n            </div>\r\n          </div>\r\n\r\n\r\n\r\n\r\n        </div>\r\n      </CssApp>\r\n    );\r\n  }\r\n}\r\n\r\n\r\nexport default App; //dd\r\n\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport App from './App';\r\n\r\nReactDOM.render(\r\n  <App />,\r\n  document.getElementById('root')\r\n);\r\n\r\n"],"sourceRoot":""}